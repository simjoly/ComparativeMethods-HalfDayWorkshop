[{"path":"index.html","id":"about","chapter":"1 About","heading":"1 About","text":"document consist introduction comparative methods. contains theory well practical examples R Phylogenetic Generalized Least Squares (PGLS). developed half-day workshop consists short presentations followed R exercises. Note present document pretty much stand theory given presentations incorporated theory sections. Therefore, document contain necessary information understand examples.assume readers “reasonably” familiar R well linear regression assumptions. lot good R introductory tutorials web linear models. Zuur et al. (Zuur et al. 2007) provide good introduction linear models, mixed-effects models model comparison. Good introductions model fitting R can also found Dolph Schluter’s webpage among QCBS workshops.","code":""},{"path":"index.html","id":"useful-resources","chapter":"1 About","heading":"1.1 Useful resources","text":"links might provide additional information interest.Luke Harmon’s book - Phylogenetic Comparative MethodsLiam Revell’s blog phylogenetic tools RLiam Revell Luke Harmon book Phylogenetic comparative methods RThe list R packages phylogeniesMy tutorials Phylogenetic Comparative MethodsR package V.PhyloMaker2 can generate large phylogenies vascular plants R package U.PhyloMaker can generate large phylogenetic trees plants animals","code":""},{"path":"index.html","id":"source","chapter":"1 About","heading":"1.2 Source","text":"tutorial publicly available hosted github repository github.com/simjoly/ComparativeMethods-HalfDayWorkshop","code":""},{"path":"index.html","id":"disclaimer","chapter":"1 About","heading":"1.3 Disclaimer","text":"tutorial provided , without guaranty work analyses date.","code":""},{"path":"before.html","id":"before","chapter":"2 Ahead of the workshop","heading":"2 Ahead of the workshop","text":"things know ahead workshop.","code":""},{"path":"before.html","id":"install-r-and-the-required-packages","chapter":"2 Ahead of the workshop","heading":"2.1 Install R and the required packages","text":"perform examples document, need R software installed computer. strongly recommend install RStudio. Although R Studio required, facilitates interactions scripts R console provides many great tools.installing R, install packages. specific tutorial, need load following R packages.execute code tutorial R, suggest create new script (File>New File>R Script) paste code copied boxes. R Studio, can run code selecting lines want execute press run (associated shortcut). replicate analyses presented tutorial. save script file directory dedicated workshop also place data files required (see section 2.2). , make sure script (data) R working directory. R Studio, can set form menu: ‘Session > Set Working Directory’.packages yet installed computer, get error messages trying load . case, install using function install.packages(). install .packages installed, can load packages using library() function. Also note using packages nlme ape, nlme loaded first. don’t , might get errors; restart R start .","code":"\nlibrary(nlme)\nlibrary(ape)\nlibrary(RColorBrewer)\nlibrary(ggplot2)\ninstall.packages('nlme')\ninstall.packages('ape')\ninstall.packages('RColorBrewer')\ninstall.packages('ggplot2')"},{"path":"before.html","id":"download","chapter":"2 Ahead of the workshop","heading":"2.2 Downloading the data","text":"data need tutorial can downloaded repository: data.zip.suggest download folder, uncompress , place dedicated folder also save script commands use.","code":""},{"path":"before.html","id":"get-acquainted-with-phylogenetic-trees-in-r","chapter":"2 Ahead of the workshop","heading":"2.3 Get acquainted with phylogenetic trees in R","text":"never used phylogenetic trees R, can learn basic techniques handle simulate trees characters reading chapter 14.","code":""},{"path":"intro.html","id":"intro","chapter":"3 An introduction to Phylogenetic Comparative Methods","heading":"3 An introduction to Phylogenetic Comparative Methods","text":"Phylogenetic comparative methods introduced Joseph Felsenstein 1985. idea phylogenetic comparative methods correct non-independence species statistical tests shared evolutionary histories. Indeed, two species may look similar live environment closely related. Consider following angiosperm phylogeny.\nFigure 3.1: land plant phylogeny\nclear Fagus (beech) Pisum (pea) likely share similar characteristics compared Asplenium (fern), share recent common ancestor. words, evolutionary histories shared longer period Asplenium. , chance similar traits (fact ). instance, take two characters, ovule fertilization type, within group.Ignoring phylogeny, might tempted see strong correlation two characters. Indeed, states two characters show perfect correspondence. Using standard contingency table statistics, Fisher exact test:test suggests assotiation highly significant. However, know comparisons made completely independent. Actually, characters evolved , along branch.appropriate way frame question “probability two characters evolved along branch?”. can also calculated using contingency table, time taking branches phylogeny units observation.example, 18 branches two characters evolved branch. contingency table considering changes along branches looks like :table, Fisher’s exact test give following result:can see result longer significant.approach taking account phylogenetic relationships correct, powerful comparative methods developed. One useful powerful approach Phylogenetic Generalized Least Squares (PGLS). introduce PGLS, revision look briefly standard regression.","code":"\nfisher.test(matrix(c(5,0,0,6),ncol=2))## \n##  Fisher's Exact Test for Count Data\n## \n## data:  matrix(c(5, 0, 0, 6), ncol = 2)\n## p-value = 0.002165\n## alternative hypothesis: true odds ratio is not equal to 1\n## 95 percent confidence interval:\n##  2.842809      Inf\n## sample estimates:\n## odds ratio \n##        Inf\nfisher.test(matrix(c(1,0,0,17),ncol=2))## \n##  Fisher's Exact Test for Count Data\n## \n## data:  matrix(c(1, 0, 0, 17), ncol = 2)\n## p-value = 0.05556\n## alternative hypothesis: true odds ratio is not equal to 1\n## 95 percent confidence interval:\n##  0.4358974       Inf\n## sample estimates:\n## odds ratio \n##        Inf"},{"path":"linear-regression.html","id":"linear-regression","chapter":"4 The linear regression model","heading":"4 The linear regression model","text":"","code":""},{"path":"linear-regression.html","id":"theory","chapter":"4 The linear regression model","heading":"4.1 Theory","text":"linear model following form:\\[\\textbf{y} = \\alpha + \\beta \\textbf{x} + \\textbf{e}\\]\\(\\textbf{y}\\) response (dependent) variable, \\(\\textbf{x}\\) explanatory (independent) variable, \\(\\textbf{e}\\) represent residuals words variation explained model. simple linear regression model, represents distance observations (.e., real data) regression line (.e., prediction model) along \\(y\\) axis. parameters \\(\\alpha\\) represents intercept, \\(y\\) value regression line crosses \\(y\\) axis, whereas parameter \\(\\beta\\) represent slope line. practice, take sample size \\(N\\) get estimates \\(\\hat{\\alpha}\\) \\(\\hat{\\beta}\\) intercept slope, respectively. linear regression fitted using ordinary least squares (OLS), residuals \\(\\textbf{e}\\) assumed normally distributed expectation \\(0\\) variance \\(\\sigma^2\\). mathematical terms, \\(\\textbf{e} \\sim N(0,\\sigma^2)\\).Obtaining reliable estimates linear regression implies data meets several assumptions, amongst normality, homogeneity, fixed \\(X\\), independence, correct model specification. won’t review , focus one often violated data phylogenetically structured, independence. assumption important lack independence invalidates important tests F-test t-test.get violation independence \\(\\textbf{y}_i\\) value \\(\\textbf{x}_i\\) influenced \\(\\textbf{x}_i\\). Obviously, can happen phylogenetically structured data response variable likely react similarly closely related species share many characters decent. words, \\(y\\) value species completely independent \\(y\\) value closely related species: \\(y\\) correlated. ’ll illustrate example .","code":""},{"path":"linear-regression.html","id":"practice","chapter":"4 The linear regression model","heading":"4.2 Practice","text":"provide pratical examples workshop, use dataset tree functional traits province Quebec (Paquette, Joly, Messier 2015). dataset consists number plant functional traits molecular phylogeny built using plant barcode markers rbcL matK. dataset need run examples already /data/ folder github repository. However, can also download clicking links .seedplants.treseedplants.csvBefore analysing data, start opening data phylogenetic tree clean keep species present tree trait table. necessary additional species included phylogenetic tree analysis.Now, can look data, order plant trait order species tree.Now data ready, let’s fit linear model try explain shade tolerance (Shade) trees using wood density (Wd). R, simple way regression use function ‘lm’, stands linear model. fit linear model, need tell lm function variable response variable one explanatory variable. done using formulas form Shade ~ Wd. variable left tilde (‘~’) response variable (Shade) whereas explanatory variale (1 ) right tilde.can see slope estimate (parameter Wd) 1.81 significant (\\(p\\)=0.252). standard descriptive plots obtained plot(shade.lm) show slightly greater variation residuals low fitted values, extreme. However, another way assumption independence can violated residuals phylogenetically correlated. One way test plot residuals tips phylogeny. Let’s see gives.can see several cases, closely related species tend similar residuals (color, means side regression slope). problematic. Indeed, shows assumption independence ordinary least squares (OLS) regression longer holds statistical tests null hypotheses longer valid. see next phylogenetic generalized least squares can correct .","code":"\nrequire(ape)\n# Open the documents; it assumes that you are in the main directory of the workshop folder\nseedplantstree <- read.nexus(\"./data/seedplants.tre\")\nseedplantsdata <- read.csv2(\"./data/seedplants.csv\")\n# Remove species for which we don't have complete data\nseedplantsdata <- na.omit(seedplantsdata)\n# Remove species in the tree that are not in the data matrix\nspecies.to.exclude <- seedplantstree$tip.label[!(seedplantstree$tip.label %in% seedplantsdata$Code)]\nseedplantstree <- drop.tip(seedplantstree,species.to.exclude)\n# Remove unnecessary object\nrm(species.to.exclude)\n# Order the tree to make it nicer when plotting\nseedplantstree <- ladderize(seedplantstree, right = FALSE)\n# Now let's look at the tree\nplot(seedplantstree,cex=0.4)\n# Here is what the loaded data looks like\nhead(seedplantsdata)##   Code       Species.name Occurrence maxH   Wd    Sm Shade    N\n## 1 ABBA     Abies balsamea       7759   25 0.34   7.6   5.0 1.66\n## 2 ACNE       Acer negundo          0   20 0.44  34.0   3.5 2.50\n## 3 ACNI        Acer nigrum          1   30 0.52  65.0   3.0 1.83\n## 4 ACPE Acer pensylvanicum        665   10 0.44  41.0   3.5 2.22\n## 5 ACPL   Acer platanoides          0   15 0.51 172.0   4.2 1.99\n## 6 ACRU        Acer rubrum       3669   25 0.49  20.0   3.4 1.91\n# Name the rows of the data.frame with the species codes used as tree labels \nrownames(seedplantsdata) <- seedplantsdata$Code\n# Order the data in the same order as the tip.label of the tree. In the present \n#  example, this was already the case, but it is an important step for \n#  any analysis.\nseedplantsdata <- seedplantsdata[seedplantstree$tip.label,]\n# Fit a linear model using Ordinary Least Squares (OLS)\nshade.lm <- lm(Shade ~ Wd, data = seedplantsdata)\n# Print the results\nsummary(shade.lm)## \n## Call:\n## lm(formula = Shade ~ Wd, data = seedplantsdata)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -1.87120 -1.02501  0.05628  0.70132  2.38261 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)  \n## (Intercept)   2.0010     0.7501   2.668    0.010 *\n## Wd            1.8130     1.5676   1.157    0.252  \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 1.146 on 55 degrees of freedom\n## Multiple R-squared:  0.02374,    Adjusted R-squared:  0.005992 \n## F-statistic: 1.338 on 1 and 55 DF,  p-value: 0.2525\n# Extract the residuals\nshade.res <- residuals(shade.lm)\n\n#\n# Plot the residuals beside the phylogeny\n\n# The following command changes the graphical parameters for nicer tree output\nop <- par(mar=c(1,1,1,1))\n# Vector of colors for the tree plotting\ncols <- c(\"#7570b3\",\"#d95f02\")\n# The next three commands will plot the tree, then circles that reflect \n#  the residuals values at the tips of the tree, and will finally\n#  add a legend.\n# The plot command plots the tree and leaves some space to plot the \n#  residuals at the tips with the 'label.offset=0.01' option\nplot(seedplantstree,type=\"p\",TRUE,label.offset=0.01,cex=0.5,no.margin=FALSE)\n# The next command plots the residuals. the 'bg' option is for the background color.\n#  If the residuals are greater than 0 (shade.res>0), it will print the first color\n#  (1) of the 'cols' array and if it is below zero, it prints the second color (2). \n#  The the size of the circle (the 'cex' option) is relative to the absolute value \n#  of the residuals (abs(shade.res). To plot other values, just replace the \n#  'shade.res' vector by another one.\ntiplabels(pch=21,bg=cols[ifelse(shade.res>0,1,2)],col=\"black\",cex=abs(shade.res),adj=0.505)\n# Print the legend\nlegend(\"topleft\",legend=c(\"-2\",\"-1\",\"0\",\"1\",\"2\"),pch=21,\n       pt.bg=cols[c(1,1,1,2,2)],bty=\"n\",\n       text.col=\"gray32\",cex=0.8,pt.cex=c(2,1,0.1,1,2))\n# Reset graphical parameters to defaults\npar(op) "},{"path":"linear-regression.html","id":"challenge-1","chapter":"4 The linear regression model","heading":"4.3 Challenge 1","text":"seedplantsdata data frame, many different traits. Try fit regression tree shade tolerance (shade) seed mass (Sm). words, test shade tolerance can explained seed mass trees. , try see residuals phylogenetically correlated.","code":""},{"path":"pgls.html","id":"pgls","chapter":"5 Phylogenetic generalized least squares (PGLS)","heading":"5 Phylogenetic generalized least squares (PGLS)","text":"","code":""},{"path":"pgls.html","id":"theory-1","chapter":"5 Phylogenetic generalized least squares (PGLS)","heading":"5.1 Theory","text":"Phylogenetic generalized least squares (PGLS) just specific application broader method called generalized least squares (GLS). Generalized least squares relax assumption error linear model uncorrelated. allow user specify structure residual correlation. used, instance, correct spatial correlation, time series, phylogenetic correlation.GLS structure Ordinary Least Squares (OLS):\\[\\textbf{y} = \\alpha + \\beta \\textbf{x} + \\textbf{e}\\]difference residuals correlated according correlation structure \\(\\textbf{C}\\):\\[\\textbf{e} \\sim N(0,\\sigma^2\\textbf{C})\\], \\(\\textbf{C}\\) correlation matrix describes residuals correlated . able account phylogenetic relationships PGLS, thus need able express phylogenetic relationships form correlation matrix.","code":""},{"path":"pgls.html","id":"phylogenetic-correlation-structure","chapter":"5 Phylogenetic generalized least squares (PGLS)","heading":"5.1.1 Phylogenetic correlation structure","text":"Phylogenetic relationships can described using correlation structure. , phylogenetic tree branch lengths indicated branches.Now, tree can perfectly represented variance-covariance matrix.diagonal elements matrix species variances; numbers represent total distance root tree tips. determines much tips evolved root. -diagonal elements covariances species. indicate proportion time species evolved together. corresponds length branches two species share, starting root tree. instance, species \\(\\) \\(c\\) shared common history 0.5 units time; hence covariance 0.5. greater covariance, longer two species shared evolutionary history.variation among species due phylogeny none selection, variance-covariance matrix represent expectation much species similar species.Note tips equidistant root. trees property, said ultrametric. phylogenetic comparative methods require trees ultrametric, although sometimes ways relax assumption. ultrametric tree, possible make ultrametric using function chronopl ape package. ideally, better use phylogenetic method directly reconstruct ultrametric trees.variance-covariance matrix phylogenetic tree can obtained tree using function vcv ape package.great, mentioned correlation matric need GLS account correlation residuals. obtain correlation matrix variance-covariance matrix shown , need divide variance-covariance matrix length tree, distance root tips. can also obtained using R function cov2cor.Now, diagonal elements equal 1, indicating species perfectly correlated . Note also possible obtain directly correlation matrix function vcv using corr=TRUE option.Now know obtain correlation matrix phylogenetic tree, ready run PGLS.","code":"##      a    b    c    d    e\n## a 1.05 0.90 0.50 0.00 0.00\n## b 0.90 1.05 0.50 0.00 0.00\n## c 0.50 0.50 1.05 0.00 0.00\n## d 0.00 0.00 0.00 1.05 0.80\n## e 0.00 0.00 0.00 0.80 1.05\n# 'atree' corresponds to the phylogenetic tree shown above in newick format\natree <- \"(((a:0.15,b:0.15):0.4,c:0.55):0.5,(d:0.25,e:0.25):0.8);\"\n# Let's now read this tree and store it as a phylogenetic tree object in R\natree <- read.tree(text=atree)\n# Show the tree\nplot(atree)\n# Extract the variance-covariance matrix\nvarcovar <- vcv(atree)\n# Print the variance-covariance matrix\nvarcovar##      a    b    c    d    e\n## a 1.05 0.90 0.50 0.00 0.00\n## b 0.90 1.05 0.50 0.00 0.00\n## c 0.50 0.50 1.05 0.00 0.00\n## d 0.00 0.00 0.00 1.05 0.80\n## e 0.00 0.00 0.00 0.80 1.05\n# Convert the covariance matrix to a correlation matrix\ncorrmat <- cov2cor(varcovar)\n# Print the matrix, rounding the numbers to three decimals\nround(corrmat,3)##       a     b     c     d     e\n## a 1.000 0.857 0.476 0.000 0.000\n## b 0.857 1.000 0.476 0.000 0.000\n## c 0.476 0.476 1.000 0.000 0.000\n## d 0.000 0.000 0.000 1.000 0.762\n## e 0.000 0.000 0.000 0.762 1.000\n# Obtaining a correlation matrix using the 'vcv' function\ncorrmat <- vcv(atree,corr=TRUE)\nround(corrmat,3)##       a     b     c     d     e\n## a 1.000 0.857 0.476 0.000 0.000\n## b 0.857 1.000 0.476 0.000 0.000\n## c 0.476 0.476 1.000 0.000 0.000\n## d 0.000 0.000 0.000 1.000 0.762\n## e 0.000 0.000 0.000 0.762 1.000"},{"path":"pgls.html","id":"challenge-2","chapter":"5 Phylogenetic generalized least squares (PGLS)","heading":"5.2 Challenge 2","text":"Can get covariance matrix correlation matrix seed plants phylogenetic tree example (seedplantstree)?","code":""},{"path":"pgls.html","id":"practicals","chapter":"5 Phylogenetic generalized least squares (PGLS)","heading":"5.3 Practicals","text":"several ways run PGLS R. instance, package caper well known package PGLS. However, use function gls nlme package. function robust advantage flexible. Indeed, allows easily use complex models mixed effect models, although discussed .run PGLS, let’s run basic model function gls reference. Running standard linear model package nlme allow run model comparison functions R (see ), possible different models fitted using different packages.can see output essentially identical lm function. However, differences. One presence item “Correlation:” gives correlation among estimated parameters. Also, “Standardized residuals” raw residuals divided residual standard error (raw residuals can output residuals(shade.gls,\"response\")).Now, let’s run PGLS model. assign correlation matrix gls function, simply need use corr option gls function. However, need use specific correlation function R understands correlation matrix estimate model correctly.several different types correlation structures available R. start using one simplest one, called corSymm, assumes correlation matrix symmetric. case phylogenetic trees; correlation species \\(\\) \\(b\\) \\(b\\) ad \\(\\). lower triangular part matrix passed corSymm structure. mat correlation matrix, done using command mat[lower.tri(mat)]. pass correlation matrix gls using correlation argument.Note term fixed=TRUE corSymm structure indicates correlation structure fixed parameter optimization.output similar model without correlation, except output correlation matrix.Interestingly, can see coefficient estimate slope greater (4.361) standard regression also significant (\\(p\\)=0.0127). positive example PGLS. Indeed, relationship shade tolerance wood density obscured phylogenetic correlation residuals. correlation accounted , significant relationship revealed.significant relationship shade tolerance wood density actually make sense, even though relationship likely causal. Indeed, shade tolerant trees generally sucessional species often grow slower, partly limited light availability, thus tend develop higher density woods.Now, let’s look residuals model. extract residuals corrected correlation structure, need ask normalized residuals.compare ordinary least squares optimization, residuals much less phylogenetically correlated.","code":"\nrequire(nlme)\nshade.pgls0 <- gls(Shade ~ Wd, data = seedplantsdata)\nsummary(shade.pgls0)## Generalized least squares fit by REML\n##   Model: Shade ~ Wd \n##   Data: seedplantsdata \n##       AIC     BIC    logLik\n##   180.472 186.494 -87.23602\n## \n## Coefficients:\n##               Value Std.Error  t-value p-value\n## (Intercept) 2.00098 0.7500707 2.667722  0.0100\n## Wd          1.81296 1.5675668 1.156544  0.2525\n## \n##  Correlation: \n##    (Intr)\n## Wd -0.979\n## \n## Standardized residuals:\n##         Min          Q1         Med          Q3         Max \n## -1.63307700 -0.89457443  0.04911902  0.61207032  2.07940955 \n## \n## Residual standard error: 1.145813 \n## Degrees of freedom: 57 total; 55 residual\n# Calculate the correlation matrix from the tree\nmat <- vcv(seedplantstree,corr=TRUE)\n# Create the correlation structure for gls\ncorr.struct <- corSymm(mat[lower.tri(mat)],fixed=TRUE)\n# Run the pgls\nshade.pgls1 <- gls(Shade ~ Wd, data = seedplantsdata, correlation=corr.struct)\nsummary(shade.pgls1)## Generalized least squares fit by REML\n##   Model: Shade ~ Wd \n##   Data: seedplantsdata \n##        AIC      BIC    logLik\n##   214.3762 220.3982 -104.1881\n## \n## Correlation Structure: General\n##  Formula: ~1 \n##  Parameter estimate(s):\n##  Correlation: \n##    1     2     3     4     5     6     7     8     9     10    11    12   \n## 2  0.000                                                                  \n## 3  0.000 0.967                                                            \n## 4  0.000 0.967 0.976                                                      \n## 5  0.000 0.967 0.981 0.976                                                \n## 6  0.000 0.967 0.974 0.974 0.974                                          \n## 7  0.000 0.967 0.997 0.976 0.981 0.974                                    \n## 8  0.000 0.967 0.974 0.974 0.974 0.997 0.974                              \n## 9  0.000 0.967 0.976 0.983 0.976 0.974 0.976 0.974                        \n## 10 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654                  \n## 11 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.984            \n## 12 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726      \n## 13 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.952 0.952 0.726\n## 14 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.952 0.952 0.726\n## 15 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.952 0.952 0.726\n## 16 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.945 0.945 0.726\n## 17 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.876 0.876 0.726\n## 18 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.876 0.876 0.726\n## 19 0.000 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596\n## 20 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726 0.989\n## 21 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.835 0.835 0.726\n## 22 0.000 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596\n## 23 0.000 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596\n## 24 0.000 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596 0.596\n## 25 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.876 0.876 0.726\n## 26 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.876 0.876 0.726\n## 27 0.528 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 28 0.843 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 29 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726 0.983\n## 30 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.945 0.945 0.726\n## 31 0.860 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 32 0.860 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 33 0.860 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 34 0.860 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 35 0.860 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 36 0.860 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 37 0.860 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 38 0.000 0.523 0.523 0.523 0.523 0.523 0.523 0.523 0.523 0.523 0.523 0.523\n## 39 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.675 0.675 0.675\n## 40 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.675 0.675 0.675\n## 41 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.675 0.675 0.675\n## 42 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.675 0.675 0.675\n## 43 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726 0.898\n## 44 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726 0.898\n## 45 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726 0.898\n## 46 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.835 0.835 0.726\n## 47 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.835 0.835 0.726\n## 48 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.835 0.835 0.726\n## 49 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.835 0.835 0.726\n## 50 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.675 0.675 0.675\n## 51 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726 0.980\n## 52 0.528 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 53 0.000 0.720 0.720 0.720 0.720 0.720 0.720 0.720 0.720 0.654 0.654 0.654\n## 54 0.906 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 55 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726 0.800\n## 56 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726 0.800\n## 57 0.000 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.726 0.726 0.800\n##    13    14    15    16    17    18    19    20    21    22    23    24   \n## 2                                                                         \n## 3                                                                         \n## 4                                                                         \n## 5                                                                         \n## 6                                                                         \n## 7                                                                         \n## 8                                                                         \n## 9                                                                         \n## 10                                                                        \n## 11                                                                        \n## 12                                                                        \n## 13                                                                        \n## 14 0.998                                                                  \n## 15 0.994 0.994                                                            \n## 16 0.945 0.945 0.945                                                      \n## 17 0.876 0.876 0.876 0.876                                                \n## 18 0.876 0.876 0.876 0.876 0.998                                          \n## 19 0.596 0.596 0.596 0.596 0.596 0.596                                    \n## 20 0.726 0.726 0.726 0.726 0.726 0.726 0.596                              \n## 21 0.835 0.835 0.835 0.835 0.835 0.835 0.596 0.726                        \n## 22 0.596 0.596 0.596 0.596 0.596 0.596 0.715 0.596 0.596                  \n## 23 0.596 0.596 0.596 0.596 0.596 0.596 0.715 0.596 0.596 0.997            \n## 24 0.596 0.596 0.596 0.596 0.596 0.596 0.715 0.596 0.596 0.999 0.997      \n## 25 0.876 0.876 0.876 0.876 0.984 0.984 0.596 0.726 0.835 0.596 0.596 0.596\n## 26 0.876 0.876 0.876 0.876 0.984 0.984 0.596 0.726 0.835 0.596 0.596 0.596\n## 27 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 28 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 29 0.726 0.726 0.726 0.726 0.726 0.726 0.596 0.983 0.726 0.596 0.596 0.596\n## 30 0.945 0.945 0.945 0.988 0.876 0.876 0.596 0.726 0.835 0.596 0.596 0.596\n## 31 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 32 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 33 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 34 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 35 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 36 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 37 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 38 0.523 0.523 0.523 0.523 0.523 0.523 0.523 0.523 0.523 0.523 0.523 0.523\n## 39 0.675 0.675 0.675 0.675 0.675 0.675 0.596 0.675 0.675 0.596 0.596 0.596\n## 40 0.675 0.675 0.675 0.675 0.675 0.675 0.596 0.675 0.675 0.596 0.596 0.596\n## 41 0.675 0.675 0.675 0.675 0.675 0.675 0.596 0.675 0.675 0.596 0.596 0.596\n## 42 0.675 0.675 0.675 0.675 0.675 0.675 0.596 0.675 0.675 0.596 0.596 0.596\n## 43 0.726 0.726 0.726 0.726 0.726 0.726 0.596 0.898 0.726 0.596 0.596 0.596\n## 44 0.726 0.726 0.726 0.726 0.726 0.726 0.596 0.898 0.726 0.596 0.596 0.596\n## 45 0.726 0.726 0.726 0.726 0.726 0.726 0.596 0.898 0.726 0.596 0.596 0.596\n## 46 0.835 0.835 0.835 0.835 0.835 0.835 0.596 0.726 0.881 0.596 0.596 0.596\n## 47 0.835 0.835 0.835 0.835 0.835 0.835 0.596 0.726 0.881 0.596 0.596 0.596\n## 48 0.835 0.835 0.835 0.835 0.835 0.835 0.596 0.726 0.881 0.596 0.596 0.596\n## 49 0.835 0.835 0.835 0.835 0.835 0.835 0.596 0.726 0.881 0.596 0.596 0.596\n## 50 0.675 0.675 0.675 0.675 0.675 0.675 0.596 0.675 0.675 0.596 0.596 0.596\n## 51 0.726 0.726 0.726 0.726 0.726 0.726 0.596 0.980 0.726 0.596 0.596 0.596\n## 52 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 53 0.654 0.654 0.654 0.654 0.654 0.654 0.596 0.654 0.654 0.596 0.596 0.596\n## 54 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 55 0.726 0.726 0.726 0.726 0.726 0.726 0.596 0.800 0.726 0.596 0.596 0.596\n## 56 0.726 0.726 0.726 0.726 0.726 0.726 0.596 0.800 0.726 0.596 0.596 0.596\n## 57 0.726 0.726 0.726 0.726 0.726 0.726 0.596 0.800 0.726 0.596 0.596 0.596\n##    25    26    27    28    29    30    31    32    33    34    35    36   \n## 2                                                                         \n## 3                                                                         \n## 4                                                                         \n## 5                                                                         \n## 6                                                                         \n## 7                                                                         \n## 8                                                                         \n## 9                                                                         \n## 10                                                                        \n## 11                                                                        \n## 12                                                                        \n## 13                                                                        \n## 14                                                                        \n## 15                                                                        \n## 16                                                                        \n## 17                                                                        \n## 18                                                                        \n## 19                                                                        \n## 20                                                                        \n## 21                                                                        \n## 22                                                                        \n## 23                                                                        \n## 24                                                                        \n## 25                                                                        \n## 26 0.992                                                                  \n## 27 0.000 0.000                                                            \n## 28 0.000 0.000 0.528                                                      \n## 29 0.726 0.726 0.000 0.000                                                \n## 30 0.876 0.876 0.000 0.000 0.726                                          \n## 31 0.000 0.000 0.528 0.843 0.000 0.000                                    \n## 32 0.000 0.000 0.528 0.843 0.000 0.000 0.874                              \n## 33 0.000 0.000 0.528 0.843 0.000 0.000 0.985 0.874                        \n## 34 0.000 0.000 0.528 0.843 0.000 0.000 0.997 0.874 0.985                  \n## 35 0.000 0.000 0.528 0.843 0.000 0.000 0.874 0.965 0.874 0.874            \n## 36 0.000 0.000 0.528 0.843 0.000 0.000 0.999 0.874 0.985 0.997 0.874      \n## 37 0.000 0.000 0.528 0.843 0.000 0.000 0.874 0.926 0.874 0.874 0.926 0.874\n## 38 0.523 0.523 0.000 0.000 0.523 0.523 0.000 0.000 0.000 0.000 0.000 0.000\n## 39 0.675 0.675 0.000 0.000 0.675 0.675 0.000 0.000 0.000 0.000 0.000 0.000\n## 40 0.675 0.675 0.000 0.000 0.675 0.675 0.000 0.000 0.000 0.000 0.000 0.000\n## 41 0.675 0.675 0.000 0.000 0.675 0.675 0.000 0.000 0.000 0.000 0.000 0.000\n## 42 0.675 0.675 0.000 0.000 0.675 0.675 0.000 0.000 0.000 0.000 0.000 0.000\n## 43 0.726 0.726 0.000 0.000 0.898 0.726 0.000 0.000 0.000 0.000 0.000 0.000\n## 44 0.726 0.726 0.000 0.000 0.898 0.726 0.000 0.000 0.000 0.000 0.000 0.000\n## 45 0.726 0.726 0.000 0.000 0.898 0.726 0.000 0.000 0.000 0.000 0.000 0.000\n## 46 0.835 0.835 0.000 0.000 0.726 0.835 0.000 0.000 0.000 0.000 0.000 0.000\n## 47 0.835 0.835 0.000 0.000 0.726 0.835 0.000 0.000 0.000 0.000 0.000 0.000\n## 48 0.835 0.835 0.000 0.000 0.726 0.835 0.000 0.000 0.000 0.000 0.000 0.000\n## 49 0.835 0.835 0.000 0.000 0.726 0.835 0.000 0.000 0.000 0.000 0.000 0.000\n## 50 0.675 0.675 0.000 0.000 0.675 0.675 0.000 0.000 0.000 0.000 0.000 0.000\n## 51 0.726 0.726 0.000 0.000 0.980 0.726 0.000 0.000 0.000 0.000 0.000 0.000\n## 52 0.000 0.000 0.918 0.528 0.000 0.000 0.528 0.528 0.528 0.528 0.528 0.528\n## 53 0.654 0.654 0.000 0.000 0.654 0.654 0.000 0.000 0.000 0.000 0.000 0.000\n## 54 0.000 0.000 0.528 0.843 0.000 0.000 0.860 0.860 0.860 0.860 0.860 0.860\n## 55 0.726 0.726 0.000 0.000 0.800 0.726 0.000 0.000 0.000 0.000 0.000 0.000\n## 56 0.726 0.726 0.000 0.000 0.800 0.726 0.000 0.000 0.000 0.000 0.000 0.000\n## 57 0.726 0.726 0.000 0.000 0.800 0.726 0.000 0.000 0.000 0.000 0.000 0.000\n##    37    38    39    40    41    42    43    44    45    46    47    48   \n## 2                                                                         \n## 3                                                                         \n## 4                                                                         \n## 5                                                                         \n## 6                                                                         \n## 7                                                                         \n## 8                                                                         \n## 9                                                                         \n## 10                                                                        \n## 11                                                                        \n## 12                                                                        \n## 13                                                                        \n## 14                                                                        \n## 15                                                                        \n## 16                                                                        \n## 17                                                                        \n## 18                                                                        \n## 19                                                                        \n## 20                                                                        \n## 21                                                                        \n## 22                                                                        \n## 23                                                                        \n## 24                                                                        \n## 25                                                                        \n## 26                                                                        \n## 27                                                                        \n## 28                                                                        \n## 29                                                                        \n## 30                                                                        \n## 31                                                                        \n## 32                                                                        \n## 33                                                                        \n## 34                                                                        \n## 35                                                                        \n## 36                                                                        \n## 37                                                                        \n## 38 0.000                                                                  \n## 39 0.000 0.523                                                            \n## 40 0.000 0.523 0.959                                                      \n## 41 0.000 0.523 0.964 0.959                                                \n## 42 0.000 0.523 0.964 0.959 0.982                                          \n## 43 0.000 0.523 0.675 0.675 0.675 0.675                                    \n## 44 0.000 0.523 0.675 0.675 0.675 0.675 0.986                              \n## 45 0.000 0.523 0.675 0.675 0.675 0.675 0.998 0.986                        \n## 46 0.000 0.523 0.675 0.675 0.675 0.675 0.726 0.726 0.726                  \n## 47 0.000 0.523 0.675 0.675 0.675 0.675 0.726 0.726 0.726 0.997            \n## 48 0.000 0.523 0.675 0.675 0.675 0.675 0.726 0.726 0.726 0.997 0.999      \n## 49 0.000 0.523 0.675 0.675 0.675 0.675 0.726 0.726 0.726 0.984 0.984 0.984\n## 50 0.000 0.523 0.936 0.936 0.936 0.936 0.675 0.675 0.675 0.675 0.675 0.675\n## 51 0.000 0.523 0.675 0.675 0.675 0.675 0.898 0.898 0.898 0.726 0.726 0.726\n## 52 0.528 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 53 0.000 0.523 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654\n## 54 0.860 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## 55 0.000 0.523 0.675 0.675 0.675 0.675 0.800 0.800 0.800 0.726 0.726 0.726\n## 56 0.000 0.523 0.675 0.675 0.675 0.675 0.800 0.800 0.800 0.726 0.726 0.726\n## 57 0.000 0.523 0.675 0.675 0.675 0.675 0.800 0.800 0.800 0.726 0.726 0.726\n##    49    50    51    52    53    54    55    56   \n## 2                                                 \n## 3                                                 \n## 4                                                 \n## 5                                                 \n## 6                                                 \n## 7                                                 \n## 8                                                 \n## 9                                                 \n## 10                                                \n## 11                                                \n## 12                                                \n## 13                                                \n## 14                                                \n## 15                                                \n## 16                                                \n## 17                                                \n## 18                                                \n## 19                                                \n## 20                                                \n## 21                                                \n## 22                                                \n## 23                                                \n## 24                                                \n## 25                                                \n## 26                                                \n## 27                                                \n## 28                                                \n## 29                                                \n## 30                                                \n## 31                                                \n## 32                                                \n## 33                                                \n## 34                                                \n## 35                                                \n## 36                                                \n## 37                                                \n## 38                                                \n## 39                                                \n## 40                                                \n## 41                                                \n## 42                                                \n## 43                                                \n## 44                                                \n## 45                                                \n## 46                                                \n## 47                                                \n## 48                                                \n## 49                                                \n## 50 0.675                                          \n## 51 0.726 0.675                                    \n## 52 0.000 0.000 0.000                              \n## 53 0.654 0.654 0.654 0.000                        \n## 54 0.000 0.000 0.000 0.528 0.000                  \n## 55 0.726 0.675 0.800 0.000 0.654 0.000            \n## 56 0.726 0.675 0.800 0.000 0.654 0.000 0.983      \n## 57 0.726 0.675 0.800 0.000 0.654 0.000 0.999 0.983\n## \n## Coefficients:\n##                Value Std.Error   t-value p-value\n## (Intercept) 0.911433  4.409058 0.2067184  0.8370\n## Wd          4.361028  1.693349 2.5753865  0.0127\n## \n##  Correlation: \n##    (Intr)\n## Wd -0.166\n## \n## Standardized residuals:\n##         Min          Q1         Med          Q3         Max \n## -0.26890642 -0.16431866 -0.02645422  0.09638984  0.34953444 \n## \n## Residual standard error: 7.455109 \n## Degrees of freedom: 57 total; 55 residual\n# Extract the residuals corrected by the correlation structure\npgls1.res <- residuals(shade.pgls1,type=\"normalized\")\n# Change the graphical parameters\nop <- par(mar=c(1,1,1,1))\n# Same plotting as above except for using pgls1.res as residuals\nplot(seedplantstree,type=\"p\",TRUE,label.offset=0.01,cex=0.5,no.margin=FALSE)\ntiplabels(pch=21,bg=cols[ifelse(pgls1.res>0,1,2)],col=\"black\",\n          cex=abs(pgls1.res),adj=0.505)\nlegend(\"topleft\",legend=c(\"-2\",\"-1\",\"0\",\"1\",\"2\"),pch=21,\n       pt.bg=cols[c(1,1,1,2,2)],bty=\"n\",\n       text.col=\"black\",cex=0.8,pt.cex=c(2,1,0.1,1,2))\n# Reset graphical parameters to defaults\npar(op) "},{"path":"pgls.html","id":"other-correlation-structures","chapter":"5 Phylogenetic generalized least squares (PGLS)","heading":"5.3.1 Other correlation structures","text":"previous PGLS, used corSymm structure pass phylogenetic correlation structure gls. perfectly fine, simple ways. Julien Dutheil developped phylogenetic structures used especially PGLS.one used equivalent corBrownian structure ape. approach easier just pass tree correlation structure. example using corBrownian structure.can see results identical. difference correlation structure outputed summary. numeric(0) means parameter estimated optimization (fixed).Now, might wonder correlation structure called corBrownian. uses Brownian motion model evolution along branch tree. often refferred neutral model. want know Brownian Motion model, can look section 12 model.","code":"\n# Get the correlation structure\nbm.corr <- corBrownian(phy=seedplantstree, form=~1)\n# PGLS\nshade.pgls1b <- gls(Shade ~ Wd, data = seedplantsdata, correlation=bm.corr)## Warning in Initialize.corPhyl(X[[i]], ...): No covariate specified, species\n## will be taken as ordered in the data frame. To avoid this message, specify a\n## covariate containing the species names with the 'form' argument.\nsummary(shade.pgls1b)## Generalized least squares fit by REML\n##   Model: Shade ~ Wd \n##   Data: seedplantsdata \n##        AIC      BIC    logLik\n##   214.3762 220.3982 -104.1881\n## \n## Correlation Structure: corBrownian\n##  Formula: ~1 \n##  Parameter estimate(s):\n## numeric(0)\n## \n## Coefficients:\n##                Value Std.Error   t-value p-value\n## (Intercept) 0.911433  4.409058 0.2067184  0.8370\n## Wd          4.361028  1.693349 2.5753865  0.0127\n## \n##  Correlation: \n##    (Intr)\n## Wd -0.166\n## \n## Standardized residuals:\n##         Min          Q1         Med          Q3         Max \n## -0.26890642 -0.16431866 -0.02645422  0.09638984  0.34953444 \n## \n## Residual standard error: 7.455109 \n## Degrees of freedom: 57 total; 55 residual"},{"path":"pgls.html","id":"challenge-3","chapter":"5 Phylogenetic generalized least squares (PGLS)","heading":"5.4 Challenge 3","text":"Fit PGLS model see whether seed mass (Sm) explains shade tolerance (Shade) seedplantdataset. compare results standard regression.","code":""},{"path":"pic.html","id":"pic","chapter":"6 Phylogenetic Independent Contrasts","heading":"6 Phylogenetic Independent Contrasts","text":"Let’s make digression look Phylogenetic Independent Contrasts (PIC). PIC first comparative approach proposed deal phylogenetic non independence (Felsenstein 1985). Although less flexible PGLS, give results. Let’s see can used.Phylogenetic independent contrast estimated one trait time. essentially transform observed trait contrasts correlated phylogeny. can done R using pic function ape package.done, thing fit regression contrast. Note important intercept fixed 0 model. done adding - 1 right formula.can see slope estimate, 4.361, identical slope estimate obtained PGLS. thing p-value. main retriction PIC limited always comparing two variables. Much flexibility possible PGLS.","code":"\n# Estimate PIC for shade tolerance \nShade.pic <- pic(seedplantsdata$Shade, phy=seedplantstree)\n# Estimate PIC for Wood density \nWd.pic <- pic(seedplantsdata$Wd, phy=seedplantstree)\n# Estimate PIC for shade tolerance\npic.results <- lm(Shade.pic ~ Wd.pic - 1)\nsummary(pic.results)## \n## Call:\n## lm(formula = Shade.pic ~ Wd.pic - 1)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -71.943  -4.106   1.013   5.679  21.614 \n## \n## Coefficients:\n##        Estimate Std. Error t value Pr(>|t|)  \n## Wd.pic    4.361      1.693   2.575   0.0127 *\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 19.21 on 55 degrees of freedom\n## Multiple R-squared:  0.1076, Adjusted R-squared:  0.09139 \n## F-statistic: 6.633 on 1 and 55 DF,  p-value: 0.01273"},{"path":"relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html","id":"relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated","chapter":"7 Relaxing the assumption that residuals need to be perfectly phylogenetically correlated","heading":"7 Relaxing the assumption that residuals need to be perfectly phylogenetically correlated","text":"Phylogenetic Generalized Least Squares assume residuals perfectly phylogenetically correlated. relatively constraining means sources errors phylogenetically correlated allowed model. Moreover, exist, can bias results PGLS (Revell 2010).ways relax assumption, one use type correlation structure allows relax assumption.","code":""},{"path":"relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html","id":"theory-pagels-correlation-structure","chapter":"7 Relaxing the assumption that residuals need to be perfectly phylogenetically correlated","heading":"7.1 Theory: Pagel’s correlation structure","text":"controling phylogenetic relationships phylogenetic generalized least squares, assume residuals perfectly correlated according correlation structure. practice, might always case difficult really know important control phylogenetic relationship specific case. instance, given study, correlation residuals might highly phylogenetically correlated.possible account using \\(\\lambda\\) model Pagel (Pagel 1999). idea multiply -diagonal correlation matrix (essentially branch lengths phylogeny) parameter \\(\\lambda\\), diagonal values. essentially leads modification branch lengths phylogeny. \\(\\lambda\\) value near zero gives shorts internal branches long tip branches. , effect, reduces phylogenetic correlations (effect phylogeny reduced). opposite, \\(\\lambda\\) close 1, modified phylogeny resembles true phylogeny. Indeed, parameter \\(\\lambda\\) often interpreted parameter phylogenetic signal; , greater \\(\\lambda\\) value implies stronger phylogenetic signal.following figure shows different lambda values affect shape Quebec trees phylogeny.can see small values lambda, weight given shared history (phylogeny) greatly reduced. long terminal branches somewhat indicates lot variation residuals independent species. variation due factors included estimates species independent phylogeny (measurement errors instance).","code":""},{"path":"relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html","id":"practicals-1","chapter":"7 Relaxing the assumption that residuals need to be perfectly phylogenetically correlated","heading":"7.2 Practicals","text":"Pagel’s \\(\\lambda\\) model can used PGLS using corPagel correlation structure. usage correlation structure similar corBrownian structure, except need provide starting parameter value \\(\\lambda\\).value given corPagel starting value \\(\\lambda\\) parameter. Also, note option fixed= set FALSE means \\(\\lambda\\) parameter optimized using generalized least squares. set TRUE, model fitted starting parameter, 0.3. form=~Code points column Code dataset ordering tree order dataframe fitting function.Let’s now fit PGLS correlation structure.can see gls estimated \\(\\lambda\\) parameter, 0.958 . estimated \\(\\lambda\\) close 1, can conclude residuals model strongly phylogenetically correlated. , turns, thus confirms importance using PGLS model. \\(\\lambda\\) estimated close 0, suggested PGLS necessary. Note, however, using approach assures never obtained biased statistical result. Actually, strongly recommend always use correlation structure statistical analyses.","code":"\n# Get the correlation structure\npagel.corr <- corPagel(0.3, phy=seedplantstree, fixed=FALSE, form=~Code)\n# PGLS with coraPagel\nshade.pgls2 <- gls(Shade ~ Wd, data = seedplantsdata, correlation=pagel.corr)\nsummary(shade.pgls2)## Generalized least squares fit by REML\n##   Model: Shade ~ Wd \n##   Data: seedplantsdata \n##        AIC     BIC    logLik\n##   163.3967 171.426 -77.69833\n## \n## Correlation Structure: corPagel\n##  Formula: ~Code \n##  Parameter estimate(s):\n##    lambda \n## 0.9581665 \n## \n## Coefficients:\n##                Value Std.Error   t-value p-value\n## (Intercept) 1.254987  1.636575 0.7668377  0.4465\n## Wd          3.573527  1.497808 2.3858381  0.0205\n## \n##  Correlation: \n##    (Intr)\n## Wd -0.397\n## \n## Standardized residuals:\n##         Min          Q1         Med          Q3         Max \n## -0.75145692 -0.44908843 -0.05417524  0.25655008  0.96493685 \n## \n## Residual standard error: 2.621947 \n## Degrees of freedom: 57 total; 55 residual"},{"path":"relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html","id":"challenge-4","chapter":"7 Relaxing the assumption that residuals need to be perfectly phylogenetically correlated","heading":"7.3 Challenge 4","text":"Try fit PGLS Pagel correlation structure regressing Shade tolerance seed mass. residuals phylogenetically correlated previous regression wood density?","code":""},{"path":"relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html","id":"other-correlation-structures-or-evolutionary-models","chapter":"7 Relaxing the assumption that residuals need to be perfectly phylogenetically correlated","heading":"7.4 Other correlation structures (or evolutionary models)","text":"correlation structures available package ape offer alternatives assumed model character evolution. instance, corMartins correlation structure models selection using Ornstein-Uhlenbeck (Hansen) model parameter \\(\\alpha\\) determines strength selection. Also, corBlomberg models accelerating decelerating Brownian evolution, , evolutionary rate Brownian motion either accelerating decelerating time model. possible model comparisons decide model best fit residual variation.","code":""},{"path":"phylogenetic-anova.html","id":"phylogenetic-anova","chapter":"8 Phylogenetic ANOVA","heading":"8 Phylogenetic ANOVA","text":"far, analysed continuous quantitative characters. also possible perform ANOVA PGLS.great thing PGLS implemented gls function can easily adapted testing many different types models. give just one example , easy implement phylogenetic ANOVA R. Indeed, just need give gls categorical trait independent variable.categorical variable plant functional trait dataset, create one dividing wood density category two categories, light dense wood.can now fit phylogenetic ANOVA.can see wood density, even transformed categorical variable, significant effect shade tolerance.","code":"\n# Make categorical variable\nseedplantsdata$Wd.cat<-cut(seedplantsdata$Wd,breaks=2,labels=c(\"light\",\"dense\"))\n# Look at the result\nseedplantsdata$Wd.cat##  [1] light light dense light dense dense dense light light light light dense\n## [13] dense light light dense dense dense dense dense dense dense light dense\n## [25] light dense light light dense dense light light light light light light\n## [37] light light light light light light light light light dense dense dense\n## [49] dense light light light light light light light dense\n## Levels: light dense\n# Phylogenetic ANOVA\nshade.pgls3 <- gls(Shade ~ Wd.cat, data = seedplantsdata, correlation=pagel.corr)\nsummary(shade.pgls3)## Generalized least squares fit by REML\n##   Model: Shade ~ Wd.cat \n##   Data: seedplantsdata \n##        AIC      BIC    logLik\n##   166.7352 174.7646 -79.36762\n## \n## Correlation Structure: corPagel\n##  Formula: ~Code \n##  Parameter estimate(s):\n##    lambda \n## 0.9439646 \n## \n## Coefficients:\n##                 Value Std.Error  t-value p-value\n## (Intercept) 2.6826723 1.3844404 1.937730  0.0578\n## Wd.catdense 0.6179855 0.2526902 2.445626  0.0177\n## \n##  Correlation: \n##             (Intr)\n## Wd.catdense -0.037\n## \n## Standardized residuals:\n##         Min          Q1         Med          Q3         Max \n## -0.69257567 -0.48677930 -0.04143001  0.33640615  0.95379525 \n## \n## Residual standard error: 2.429586 \n## Degrees of freedom: 57 total; 55 residual"},{"path":"model-testing.html","id":"model-testing","chapter":"9 Model testing","heading":"9 Model testing","text":"might interested comparing different models, common approach modelisation biology. However, slight twist need aware PGLS.default method model fitting gls restricted maximum likelihood estimation (REML), obtained method=\"REML\". different standard maximum likelihood estimation (ML), can obtained method=\"ML\". difference complex, suffice say differ way variance parameters estimated. REML provides less biased parameter estimates preferred method report parameter coefficients publication. also method choice want compare models different correlation (variance) structures (Zuur et al. 2009). example, want test whether PGLS model optimized Pagel’s \\(\\lambda\\) fits data better model phylogenetic correlation (, Pagel \\(\\lambda=0\\)):can use AIC BIC compare model, likelihood ratio test. can see PGLS model fitted Pagel \\(\\lambda\\) better fit one \\(\\lambda=0\\) (smaller AIC). way, also test whether PGLS model better standard regression model corPagel structure \\(\\lambda=0\\) standard model (= phylogenetic correlation).Now, interested testing fixed parameters model, need use maximum likelihood fitting (Zuur et al. 2009). instance, want use likelihood ratio test test model wood density independent variable versus null model just intercept, can following.can see model wood density variable better model intercept. However, mentioned , REML fitting provides better parameter estimates, refit model using REML present results.","code":"\npagel.0 <- gls(Shade ~ Wd, data = seedplantsdata, \n               correlation=corPagel(0,phy=seedplantstree, \n                                    fixed=TRUE, form=~Code), \n               method=\"REML\")\npagel.fit <- gls(Shade ~ Wd, data = seedplantsdata, \n                 correlation=corPagel(0.8,phy=seedplantstree, \n                                      fixed=FALSE, form=~Code),\n                 method=\"REML\")\nanova(pagel.0,pagel.fit)##           Model df      AIC     BIC    logLik   Test  L.Ratio p-value\n## pagel.0       1  3 180.4720 186.494 -87.23602                        \n## pagel.fit     2  4 163.3967 171.426 -77.69833 1 vs 2 19.07537  <.0001\nwd <- gls(Shade ~ Wd, data = seedplantsdata,\n          correlation=corBrownian(phy=seedplantstree, form=~Code), \n          method=\"ML\")\nnull <- gls(Shade ~ 1, data = seedplantsdata,\n            correlation=corBrownian(phy=seedplantstree, form=~Code), \n            method=\"ML\")\nanova(wd,null)##      Model df      AIC      BIC    logLik   Test  L.Ratio p-value\n## wd       1  3 222.0088 228.1380 -108.0044                        \n## null     2  2 226.4988 230.5848 -111.2494 1 vs 2 6.489907  0.0108\nwd.final <- gls(Shade ~ Wd, data = seedplantsdata,\n                correlation=corBrownian(phy=seedplantstree, form=~Code), \n                method=\"REML\")\nsummary(wd.final)## Generalized least squares fit by REML\n##   Model: Shade ~ Wd \n##   Data: seedplantsdata \n##        AIC      BIC    logLik\n##   214.3762 220.3982 -104.1881\n## \n## Correlation Structure: corBrownian\n##  Formula: ~Code \n##  Parameter estimate(s):\n## numeric(0)\n## \n## Coefficients:\n##                Value Std.Error   t-value p-value\n## (Intercept) 0.911433  4.409058 0.2067184  0.8370\n## Wd          4.361028  1.693349 2.5753865  0.0127\n## \n##  Correlation: \n##    (Intr)\n## Wd -0.166\n## \n## Standardized residuals:\n##         Min          Q1         Med          Q3         Max \n## -0.26890642 -0.16431866 -0.02645422  0.09638984  0.34953444 \n## \n## Residual standard error: 7.455109 \n## Degrees of freedom: 57 total; 55 residual"},{"path":"when-should-we-use-comparative-methods.html","id":"when-should-we-use-comparative-methods","chapter":"10 When should we use comparative methods?","heading":"10 When should we use comparative methods?","text":"Comparative methods always used working datasets comprise multiple species. good advice though use method allows residuals model phylogenetically correlated, using PGLS corPagel structure using Phylogenetic Mixed Model. Previous studies shown using comparative methods results precise accurate fixed effect estimation, lower type error, greater statistical power (Revell 2010). Therefore, always advantageous use methods.common mistake use PGLS test phylogenetic signal \\(Y\\) \\(X\\) using either Pagel’s \\(\\lambda\\) Blomberg’s \\(K\\), phylogenetic signal use PGLS analyse data use standard regression. big mistake. saw earlier, PGLS corrects phylogenetic correlation residuals variables. Therefore, presence phylogenetic signal variables necessarily mean residuals phylogenetically correlated. opposite also true: variables may phylogenetically correlated residuals !Another common misconception comparative methods removes variation data related phylogeny affect interpretation variable interest. true old methods like phylogenetic autoregression first removed phylogenetic signal data analysing . approaches indeed problematic. methods presented suffer problems. account phylogenetic structure quantify , removes variation model.","code":""},{"path":"a-final-word-the-problem-of-replication.html","id":"a-final-word-the-problem-of-replication","chapter":"11 A final word: the problem of replication","heading":"11 A final word: the problem of replication","text":"Every biologist well aware importance replicating experiments order confident conclusions. lot tricky consider evolution. test hypotheses evolution, ideal approach rewind “tape evolution” (S. J. Gould) let story repeats several times see happens. unfortunately possible, although experimental evolution studies manage replicate evolutionary experiments.phylogenetic comparative method introduced tutorial one appropriate approach protect reaching conclusions strongly supported considered evolutionary context. However, even approach can sometimes fail. extra care needed studies.interpreting results, biologists first ask whether sufficient replication data allow strong conclusions made. replication, mean evolutionary replication. Consider seed plant example introduced .multiple species ovules enclosed perform double fertilization , parsimonious scenario characters evolved along branch tree leads flowering plants. words, one transition states character evolution group.even seems replication look species (several species character state sampled), evolutionary replication! even likelihood two events occurred branch small even contingency test calculate likelihood event significant, little bit like experiment one replicate. Therefore, even test accounts phylogeny significant, lot caution needed interpreting results. Ideally, study decent number evolutionary replications results biologically meaningful. encourage read nice paper Maddison Fitzjohn subject (Maddison FitzJohn 2015).Ideally, planning experiment, one make sure sufficient replication evolution traits study among species considered greater confidence results. instance, much better character evolved 5-6 times previous example, especially two characters always evolving simultaneously!","code":""},{"path":"BM-model.html","id":"BM-model","chapter":"12 The Brownian Motion (BM) model","heading":"12 The Brownian Motion (BM) model","text":"want account non-independence species due evolutionary histories statistical analyses, model evolution necessarily implied. Indeed, assume traits evolved time (along phylogeny) closely related species likely similar average given trait distantly related species. evolutionary biologogy, basic model (often used null model many analyses) Brownian motion model. model evolution named Robert Brown, celeb botanist published important Flora Australia 1810. also first distinguish gymnosperms angiosperms. discovery Brownian motion due observation small particules solution tendency move direction, observation first made observing Clarkia pollen microscope. explanation come later, terms random molecular impacts.Mathematicians constructed stochastic process intended approximate Brownian motion. model, step independent others can go direction. mean displacement zero variance uniform across parameter space. displacements can summed, means variances independent displacements can added . \\(\\sigma^2\\) variance single displacement, variance time \\(t\\) \\(\\sigma^2t\\). number steps large, phylogenetic context, result normally distributed.applied phylogenies, Brownian motion model kind applied indepenpenty branch phylogeny. allows model amount change occured along given branch. variance Brownian motion model \\(\\sigma^2\\) per unit time \\(t\\), net change along branch time \\(t\\) drawn normal distribution mean \\(0\\) variance \\(\\sigma^2t\\). model can also represented mathematically following way, amount change character \\(X\\) infinitesimal time interval time \\(t\\) \\(t+dt\\) :\\[dX(t)=\\sigma^2 dB(t),\\]\\(dB(t)\\) gaussian distribution. Importantly, model assumes :Evolution occuring branch phylogeny independent occuring branches.Evolution completely random (.e., selection).parameter \\(\\sigma^2\\) model gives variance, word speed evolution. higher variance, faster character evolve. two examples simulated characters tree 200 species \\(\\sigma^2=0.5\\) \\(\\sigma^2=4\\).thorough introduction Brownian Motion model can found chapter 23 Joe Felsenstein’s book (Felsenstein Felenstein 2004).Brownian motion model often said model neutral drift, although good fit model necessarily means data evolved via random drifts processes can also result BM-like patterns (Hansen Martins 1996).Note also model stochastic. , even two closely related species likely share similar character states distant one, true average. given simulated character, closely related species can sometimes different distant species. Look following figure, shows three traits simulated Brownian motion.","code":""},{"path":"further-readings.html","id":"further-readings","chapter":"13 Further readings","heading":"13 Further readings","text":"undertand well new research field, always advisable read lot . references might find useful. different sources also sometimes explain theory different ways use different examples, might help understand better.Felsenstein, J. (1985) Phylogenies comparative method. American Naturalist 125, 1-15. classic initial paper launched field comparative analyses. phylogenetic independent contrasts introduced hereFelsenstein, J. (2004) Inferring phylogenies. Sinauer Associates, Inc. Sunderland, MA. thorough reference phylogenies, reconstruction phylogenetic methodsHadfield, J. D., S. Nakagawa. 2010. General quantitative genetic methods comparative biology: phylogenies, taxonomies multi-trait models continuous categorical characters. Journal Evolutionary Biology 23:494–508. paper describes phylogenetic mixed model implementation MCMCglmm. important paperHousworth, E.., E.P. Martins, M. Lynch. 2004. phylogenetic mixed model. American Naturalist 163:84–96. Excellent paper Phylogenetic Mixed ModelParadis, E. (2012). Analysis phylogenetics evolution R. New York, USA: Springer. book explains analyses available R package APE. also great reference many phylogenetic analyses, including comparative method. classic must users phylogenies R.Revell, L J. (2010). Phylogenetic signal linear regression species data. Methods Ecology Evolution 1: 319-329. great paper PGLS. uses simulations show important use PGLS.Villemereuil, P., S. Nakagawa. 2014. General quantitative genetic methods comparative biology. Pp. 287–303 L. Z. Garamszegi, ed. Modern phylogenetic comparative methods application evolutionary biology. Springer-Verlag, Berlin, Heidelberg. Nice book chapter explaining phylogenetic mixed modelZuur, .F., E.N. Ieno, N. Walker, . . Saveliev, G.M. Smith. (2009). Mixed effects models extensions ecology R. New York, NY: Springer New York. book phylogenetic methods, great book analysis ecological data examples R. chapter 6 7 discuss correlation structures although phylogenies, instructive deal compare models analyse complex data. also tons information deal complex data, along correlation structure. good read!","code":""},{"path":"trees.html","id":"trees","chapter":"14 Introduction to phylogenies in R","heading":"14 Introduction to phylogenies in R","text":"lots packages phylogenetic analyses R. won’t enumerate , can good idea options available looking phylogenetic R vignette maintainned Brian O’Meara. mostly oriented towards phylogenetic comparative methods, good start.basic package using trees R ape, allows read plot trees.","code":""},{"path":"trees.html","id":"importing-and-plotting-trees","chapter":"14 Introduction to phylogenies in R","heading":"14.1 Importing and plotting trees","text":"","code":""},{"path":"trees.html","id":"simulate-a-tree","chapter":"14 Introduction to phylogenies in R","heading":"14.1.1 Simulate a tree","text":"Throughout exercises, often use simulated trees, useful pedagogical purposes. Trees can simulated using several functions, example simulate one tree 15 species.save tree nexus format file. , good idea set working directory folder script saved. can RStudio menu Session>Set Working Directory>Source File Location.","code":"\nrequire(phytools)\ntree <- pbtree(n=15,nsim=1)\nplot(tree)\nrequire(ape)\nwrite.nexus(tree, file=\"My_first_tree.tre\")"},{"path":"trees.html","id":"simulating-characters","chapter":"14 Introduction to phylogenies in R","heading":"14.1.2 Simulating characters","text":"Characters can also easily simulated R. instance, simulate character using Brownian Motion (BM) model using following code.Now, let’s save trait file pretend original data.Now simulated tree character, let’s erase done far R environment pretend data next sections.","code":"\ntrait1 <- fastBM(tree, sig2=0.01, nsim=1, internal=FALSE)\n# To get trait values for tree tips:\ntrait1##           t3           t4           t7           t8           t2          t14 \n## -0.007306853  0.043251831  0.004858391 -0.114795593 -0.043737891  0.113964926 \n##          t15           t9          t12          t13           t5           t6 \n##  0.097243984  0.096978766  0.063069656  0.053040643  0.072476832  0.034675083 \n##           t1          t10          t11 \n## -0.084659118  0.118596501  0.059071786\nwrite.table(matrix(trait1,ncol=1,dimnames=list(names(trait1),\"trait1\")), file=\"mytrait.csv\", sep=\";\")\nrm(tree, trait1)"},{"path":"trees.html","id":"import-data-into-r","chapter":"14 Introduction to phylogenies in R","heading":"14.2 Import data into R","text":"import data R.tree format ape contains several information useful know access . instance, tip labels can accessed using tree$tip.label branch lengths using tree$edge.length. see options exercises, want detailed information objects “phylo” organized, can look help file ?read.tree document prepared Emmanuel Paradis, author ape.","code":"\ntree <- read.nexus(file=\"My_first_tree.tre\")\ntrait1 <- read.csv2(file=\"mytrait.csv\",dec=\".\")"},{"path":"trees.html","id":"plot-trees","chapter":"14 Introduction to phylogenies in R","heading":"14.3 Plot trees","text":"Plotting trees one interesting aspects using R. Options numerous possibilities large. common function plot.phylo ape package lot different options. strongly suggest take close look different options function ?plot.phylo. basic example.R also interesting plot characters alongside trees. categorical character, use color tips phylogeny.similar result obtained continuous variable. , use Brownian Motion model, study class, simulate continuous character.expected character simlated Brownian motion, can see closely related species tend similar character values.Another option represent continuous parameter use function table.phylo4d adephylo package represent trait values represented sizes different sizes colors. also possible plot multiple characters time.Note install packages phylobase adephylo run function installed.can also represent traitgram:Finally, also possible represent tree 2-dimensional plot, coloring points categorical variable.","code":"\nplot(tree, type=\"c\")\nadd.scale.bar()\n# Generate a random categorical character\ntrait2 <- as.factor(sample(c(1,2,3),size=length(tree$tip.label),replace=TRUE))\n# Create color palette\nlibrary(RColorBrewer)\nColorPalette1 <- brewer.pal(n = length(levels(trait2)), name = \"Dark2\")\nplot(tree, type=\"p\", use.edge.length = TRUE, label.offset=0.2,cex=1)\ntiplabels(pch=21,bg=ColorPalette1[trait2],col=\"black\",cex=1,adj=0.6)\nop<-par(xpd=TRUE)\nlegend(0,0,legend=levels(trait2),col=ColorPalette1,\n       pch=20,bty=\"n\",cex=1,pt.cex=1.5,ncol=length(levels(trait2)))\npar(op) #reset graphical parameters to defaults\n# Breakdown continuous trait in categories\ntrait1.cat <- cut(trait1[,1],breaks=8,labels=FALSE)\n# Create color palette\nColorPalette2 <- brewer.pal(n = 8, name = \"Blues\")\n# Plot the tree\nplot(tree, type=\"p\", use.edge.length = TRUE, label.offset=0.2,cex=1)\ntiplabels(pch=21,bg=ColorPalette2[trait1.cat],col=\"black\",cex=1,adj=0.6)\nop<-par(xpd=TRUE)\nlegend(0,0,legend=levels(cut(trait1[,1],breaks=8)),\n       col=ColorPalette2,pch=20,bty=\"n\",cex=0.7,pt.cex=1.5,ncol=4)\npar(op) #reset graphical parameters to defaults\nlibrary(phylobase)\nlibrary(adephylo)\ntrait3 <- fastBM(tree, sig2=0.1, nsim=1, internal=FALSE) #simulate a faster evolving trait\ntrait.table <- data.frame(trait1=trait1[,1], trait3)\nobj <- phylo4d(tree, trait.table) # build a phylo4d object\nop <- par(mar=c(1,1,1,1))\ntable.phylo4d(obj,cex.label=1,cex.symbol=1,ratio.tree=0.8,grid=FALSE,box=FALSE)\npar(op) #reset graphical parameters to defaults\nrequire(phytools)\nphenogram(tree,trait3,spread.labels=TRUE)\nphylomorphospace(tree,trait.table)\npoints(trait.table,pch=21,bg=ColorPalette1[trait2],col=\"black\",cex=1.2,adj=1)\nlegend(\"topleft\",legend=levels(trait2),\n       col=ColorPalette1,pch=20,bty=\"n\",cex=1,pt.cex=1.5,ncol=length(levels(trait2)))"},{"path":"trees.html","id":"handling-multiple-trees","chapter":"14 Introduction to phylogenies in R","heading":"14.4 Handling multiple trees","text":"several cases, important know handle multiple trees R. normally stored multiPhylo object. Let’s see example.can see object phylo object. instance, use code plot(trees), prompted hit enter pass one tree . access individual trees, need use following technique.","code":"\ntrees <- pbtree(n=15,nsim=10)\ntrees## 10 phylogenetic trees\ntrees[[1]]## \n## Phylogenetic tree with 15 tips and 14 internal nodes.\n## \n## Tip labels:\n##   t3, t4, t5, t14, t15, t8, ...\n## \n## Rooted; includes branch lengths.\nplot(trees[[1]])"},{"path":"trees.html","id":"manipulating-trees","chapter":"14 Introduction to phylogenies in R","heading":"14.5 Manipulating trees","text":"several manipulations can made trees. examples.","code":""},{"path":"trees.html","id":"drop-tips","chapter":"14 Introduction to phylogenies in R","heading":"14.5.1 Drop tips","text":"","code":"\nplot(drop.tip(tree,c(\"t1\",\"t2\",\"t3\",\"t4\",\"t5\")))"},{"path":"trees.html","id":"reroot-trees","chapter":"14 Introduction to phylogenies in R","heading":"14.5.2 Reroot trees","text":"","code":"\nplot(root(tree,\"t1\"))"},{"path":"trees.html","id":"get-cophenetic-distances","chapter":"14 Introduction to phylogenies in R","heading":"14.5.3 Get cophenetic distances","text":"","code":"\ncophenetic.phylo(tree)##            t3        t4        t7        t8       t2        t14        t15\n## t3  0.0000000 0.7285289 3.4533793 3.4533793 3.453379 4.29496600 4.29496600\n## t4  0.7285289 0.0000000 3.4533793 3.4533793 3.453379 4.29496600 4.29496600\n## t7  3.4533793 3.4533793 0.0000000 0.4962115 1.250834 4.29496600 4.29496600\n## t8  3.4533793 3.4533793 0.4962115 0.0000000 1.250834 4.29496600 4.29496600\n## t2  3.4533793 3.4533793 1.2508336 1.2508336 0.000000 4.29496600 4.29496600\n## t14 4.2949660 4.2949660 4.2949660 4.2949660 4.294966 0.00000000 0.03691962\n## t15 4.2949660 4.2949660 4.2949660 4.2949660 4.294966 0.03691962 0.00000000\n## t9  4.2949660 4.2949660 4.2949660 4.2949660 4.294966 0.88909442 0.88909442\n## t12 4.2949660 4.2949660 4.2949660 4.2949660 4.294966 0.88909442 0.88909442\n## t13 4.2949660 4.2949660 4.2949660 4.2949660 4.294966 0.88909442 0.88909442\n## t5  7.8556290 7.8556290 7.8556290 7.8556290 7.855629 7.85562897 7.85562897\n## t6  7.8556290 7.8556290 7.8556290 7.8556290 7.855629 7.85562897 7.85562897\n## t1  7.8556290 7.8556290 7.8556290 7.8556290 7.855629 7.85562897 7.85562897\n## t10 7.8556290 7.8556290 7.8556290 7.8556290 7.855629 7.85562897 7.85562897\n## t11 7.8556290 7.8556290 7.8556290 7.8556290 7.855629 7.85562897 7.85562897\n##            t9       t12       t13        t5        t6       t1      t10\n## t3  4.2949660 4.2949660 4.2949660 7.8556290 7.8556290 7.855629 7.855629\n## t4  4.2949660 4.2949660 4.2949660 7.8556290 7.8556290 7.855629 7.855629\n## t7  4.2949660 4.2949660 4.2949660 7.8556290 7.8556290 7.855629 7.855629\n## t8  4.2949660 4.2949660 4.2949660 7.8556290 7.8556290 7.855629 7.855629\n## t2  4.2949660 4.2949660 4.2949660 7.8556290 7.8556290 7.855629 7.855629\n## t14 0.8890944 0.8890944 0.8890944 7.8556290 7.8556290 7.855629 7.855629\n## t15 0.8890944 0.8890944 0.8890944 7.8556290 7.8556290 7.855629 7.855629\n## t9  0.0000000 0.4685481 0.4685481 7.8556290 7.8556290 7.855629 7.855629\n## t12 0.4685481 0.0000000 0.2174902 7.8556290 7.8556290 7.855629 7.855629\n## t13 0.4685481 0.2174902 0.0000000 7.8556290 7.8556290 7.855629 7.855629\n## t5  7.8556290 7.8556290 7.8556290 0.0000000 0.5720997 1.742611 2.395633\n## t6  7.8556290 7.8556290 7.8556290 0.5720997 0.0000000 1.742611 2.395633\n## t1  7.8556290 7.8556290 7.8556290 1.7426110 1.7426110 0.000000 2.395633\n## t10 7.8556290 7.8556290 7.8556290 2.3956328 2.3956328 2.395633 0.000000\n## t11 7.8556290 7.8556290 7.8556290 2.3956328 2.3956328 2.395633 0.268201\n##          t11\n## t3  7.855629\n## t4  7.855629\n## t7  7.855629\n## t8  7.855629\n## t2  7.855629\n## t14 7.855629\n## t15 7.855629\n## t9  7.855629\n## t12 7.855629\n## t13 7.855629\n## t5  2.395633\n## t6  2.395633\n## t1  2.395633\n## t10 0.268201\n## t11 0.000000"},{"path":"solutions.html","id":"solutions","chapter":"15 Solutions to the challenges","heading":"15 Solutions to the challenges","text":"","code":""},{"path":"solutions.html","id":"challenge-1-1","chapter":"15 Solutions to the challenges","heading":"15.1 Challenge 1","text":"seedplantsdata data frame, many different traits. Try fit regression tree shade tolerance (shade) seed mass (Sm). words, test shade tolerance can explained seed mass trees. , try see residuals phylogenetically correlated.","code":"\n# Fit a linear model using Ordinary Least Squares (OLS)\nSm.lm <- lm(Shade ~ Sm, data = seedplantsdata)\n# Get the results\nsummary(Sm.lm)## \n## Call:\n## lm(formula = Shade ~ Sm, data = seedplantsdata)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -1.9042 -0.9009  0.1481  0.5982  2.0962 \n## \n## Coefficients:\n##               Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  2.904e+00  1.608e-01  18.064   <2e-16 ***\n## Sm          -5.824e-05  5.640e-05  -1.033    0.306    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 1.149 on 55 degrees of freedom\n## Multiple R-squared:  0.01902,    Adjusted R-squared:  0.001184 \n## F-statistic: 1.066 on 1 and 55 DF,  p-value: 0.3063\n# Extract the residuals\nSm.res <- residuals(Sm.lm)\n# Plot the residuals beside the phylogeny\nop <- par(mar=c(1,1,1,1))\nplot(seedplantstree,type=\"p\",TRUE,label.offset=0.01,cex=0.5,no.margin=FALSE)\ntiplabels(pch=21,bg=cols[ifelse(Sm.res>0,1,2)],col=\"black\",cex=abs(Sm.res),adj=0.505)\nlegend(\"topleft\",legend=c(\"-2\",\"-1\",\"0\",\"1\",\"2\"),pch=21,\n       pt.bg=cols[c(1,1,1,2,2)],bty=\"n\",\n       text.col=\"gray32\",cex=0.8,pt.cex=c(2,1,0.1,1,2))\npar(op)"},{"path":"solutions.html","id":"challenge-2-1","chapter":"15 Solutions to the challenges","heading":"15.2 Challenge 2","text":"Can get covariance matrix correlation matrix seed plants phylogenetic tree example (seedplantstree)?","code":"\n# Covariance matrix\nseedplants.cov <- vcv(seedplantstree,corr=FALSE)\n# Check the first few lines of the matrix\nhead(round(seedplants.cov,3))##       ABBA  ACNE  ACNI  ACPE  ACPL  ACRU  ACSA  ACSI  ACSP  ALCR  ALRU  AMSP\n## ABBA 0.151 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## ACNE 0.000 0.151 0.146 0.146 0.146 0.146 0.146 0.146 0.146 0.099 0.099 0.099\n## ACNI 0.000 0.146 0.151 0.147 0.148 0.147 0.150 0.147 0.147 0.099 0.099 0.099\n## ACPE 0.000 0.146 0.147 0.151 0.147 0.147 0.147 0.147 0.148 0.099 0.099 0.099\n## ACPL 0.000 0.146 0.148 0.147 0.151 0.147 0.148 0.147 0.147 0.099 0.099 0.099\n## ACRU 0.000 0.146 0.147 0.147 0.147 0.151 0.147 0.150 0.147 0.099 0.099 0.099\n##       BEAL  BEPA  BEPO  CACA  CACO  CAOV COAL  CRSP  FAGR FRAM FRNI FRPE  JUCI\n## ABBA 0.000 0.000 0.000 0.000 0.000 0.000 0.00 0.000 0.000 0.00 0.00 0.00 0.000\n## ACNE 0.099 0.099 0.099 0.099 0.099 0.099 0.09 0.099 0.099 0.09 0.09 0.09 0.099\n## ACNI 0.099 0.099 0.099 0.099 0.099 0.099 0.09 0.099 0.099 0.09 0.09 0.09 0.099\n## ACPE 0.099 0.099 0.099 0.099 0.099 0.099 0.09 0.099 0.099 0.09 0.09 0.09 0.099\n## ACPL 0.099 0.099 0.099 0.099 0.099 0.099 0.09 0.099 0.099 0.09 0.09 0.09 0.099\n## ACRU 0.099 0.099 0.099 0.099 0.099 0.099 0.09 0.099 0.099 0.09 0.09 0.09 0.099\n##       JUNI JUVI  LALA  MASP  OSVI PIAB PIBA PIGL PIMA PIRE PIRU PIST  PLOC\n## ABBA 0.000 0.08 0.127 0.000 0.000 0.13 0.13 0.13 0.13 0.13 0.13 0.13 0.000\n## ACNE 0.099 0.00 0.000 0.099 0.099 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.079\n## ACNI 0.099 0.00 0.000 0.099 0.099 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.079\n## ACPE 0.099 0.00 0.000 0.099 0.099 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.079\n## ACPL 0.099 0.00 0.000 0.099 0.099 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.079\n## ACRU 0.099 0.00 0.000 0.099 0.099 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.079\n##       POBA  PODE  POGR  POTR  PRPE  PRSE  PRVI  QUAL  QUBI  QUMA  QURU  SASP\n## ABBA 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## ACNE 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099\n## ACNI 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099\n## ACPE 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099\n## ACPL 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099\n## ACRU 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099 0.099\n##       SOAM THOC  TIAM  TSCA  ULAM  ULRU  ULTH\n## ABBA 0.000 0.08 0.000 0.137 0.000 0.000 0.000\n## ACNE 0.099 0.00 0.109 0.000 0.099 0.099 0.099\n## ACNI 0.099 0.00 0.109 0.000 0.099 0.099 0.099\n## ACPE 0.099 0.00 0.109 0.000 0.099 0.099 0.099\n## ACPL 0.099 0.00 0.109 0.000 0.099 0.099 0.099\n## ACRU 0.099 0.00 0.109 0.000 0.099 0.099 0.099\n# Correlation matrix\nseedplants.cor <- vcv(seedplantstree,corr=TRUE)\n# Check the first few lines of the matrix\nhead(round(seedplants.cor,3))##      ABBA  ACNE  ACNI  ACPE  ACPL  ACRU  ACSA  ACSI  ACSP  ALCR  ALRU  AMSP\n## ABBA    1 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## ACNE    0 1.000 0.967 0.967 0.967 0.967 0.967 0.967 0.967 0.654 0.654 0.654\n## ACNI    0 0.967 1.000 0.976 0.981 0.974 0.997 0.974 0.976 0.654 0.654 0.654\n## ACPE    0 0.967 0.976 1.000 0.976 0.974 0.976 0.974 0.983 0.654 0.654 0.654\n## ACPL    0 0.967 0.981 0.976 1.000 0.974 0.981 0.974 0.976 0.654 0.654 0.654\n## ACRU    0 0.967 0.974 0.974 0.974 1.000 0.974 0.997 0.974 0.654 0.654 0.654\n##       BEAL  BEPA  BEPO  CACA  CACO  CAOV  COAL  CRSP  FAGR  FRAM  FRNI  FRPE\n## ABBA 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## ACNE 0.654 0.654 0.654 0.654 0.654 0.654 0.596 0.654 0.654 0.596 0.596 0.596\n## ACNI 0.654 0.654 0.654 0.654 0.654 0.654 0.596 0.654 0.654 0.596 0.596 0.596\n## ACPE 0.654 0.654 0.654 0.654 0.654 0.654 0.596 0.654 0.654 0.596 0.596 0.596\n## ACPL 0.654 0.654 0.654 0.654 0.654 0.654 0.596 0.654 0.654 0.596 0.596 0.596\n## ACRU 0.654 0.654 0.654 0.654 0.654 0.654 0.596 0.654 0.654 0.596 0.596 0.596\n##       JUCI  JUNI  JUVI  LALA  MASP  OSVI PIAB PIBA PIGL PIMA PIRE PIRU PIST\n## ABBA 0.000 0.000 0.528 0.843 0.000 0.000 0.86 0.86 0.86 0.86 0.86 0.86 0.86\n## ACNE 0.654 0.654 0.000 0.000 0.654 0.654 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n## ACNI 0.654 0.654 0.000 0.000 0.654 0.654 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n## ACPE 0.654 0.654 0.000 0.000 0.654 0.654 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n## ACPL 0.654 0.654 0.000 0.000 0.654 0.654 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n## ACRU 0.654 0.654 0.000 0.000 0.654 0.654 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n##       PLOC  POBA  PODE  POGR  POTR  PRPE  PRSE  PRVI  QUAL  QUBI  QUMA  QURU\n## ABBA 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000\n## ACNE 0.523 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654\n## ACNI 0.523 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654\n## ACPE 0.523 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654\n## ACPL 0.523 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654\n## ACRU 0.523 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654 0.654\n##       SASP  SOAM  THOC TIAM  TSCA  ULAM  ULRU  ULTH\n## ABBA 0.000 0.000 0.528 0.00 0.906 0.000 0.000 0.000\n## ACNE 0.654 0.654 0.000 0.72 0.000 0.654 0.654 0.654\n## ACNI 0.654 0.654 0.000 0.72 0.000 0.654 0.654 0.654\n## ACPE 0.654 0.654 0.000 0.72 0.000 0.654 0.654 0.654\n## ACPL 0.654 0.654 0.000 0.72 0.000 0.654 0.654 0.654\n## ACRU 0.654 0.654 0.000 0.72 0.000 0.654 0.654 0.654"},{"path":"solutions.html","id":"challenge-3-1","chapter":"15 Solutions to the challenges","heading":"15.3 Challenge 3","text":"Fit PGLS model see whether seed mass (Sm) explains shade tolerance (Shade) seedplantdataset. compare results standard regression.","code":"\n# Fit a PGLS with the gls function\nSm.pgls <- gls(Shade ~ Sm, data = seedplantsdata, correlation=bm.corr)\n# Get the results\nsummary(Sm.pgls)## Generalized least squares fit by REML\n##   Model: Shade ~ Sm \n##   Data: seedplantsdata \n##        AIC      BIC    logLik\n##   240.3701 246.3921 -117.1851\n## \n## Correlation Structure: corBrownian\n##  Formula: ~1 \n##  Parameter estimate(s):\n## numeric(0)\n## \n## Coefficients:\n##                  Value Std.Error    t-value p-value\n## (Intercept)  2.8031105  4.591805  0.6104594  0.5441\n## Sm          -0.0000417  0.000081 -0.5117076  0.6109\n## \n##  Correlation: \n##    (Intr)\n## Sm -0.004\n## \n## Standardized residuals:\n##         Min          Q1         Med          Q3         Max \n## -0.22901901 -0.10170487  0.02535202  0.08873220  0.27907713 \n## \n## Residual standard error: 7.873115 \n## Degrees of freedom: 57 total; 55 residual\n# Extract the residuals corrected by the correlation structure\nSm.pgls.res <- residuals(Sm.pgls,type=\"normalized\")\n# Plot the residuals beside the phylogeny\nop <- par(mar=c(1,1,1,1))\nplot(seedplantstree,type=\"p\",TRUE,label.offset=0.01,cex=0.5,no.margin=FALSE)\ntiplabels(pch=21,bg=cols[ifelse(Sm.pgls.res>0,1,2)],col=\"black\",cex=abs(Sm.pgls.res),adj=0.505)\nlegend(\"topleft\",legend=c(\"-2\",\"-1\",\"0\",\"1\",\"2\"),pch=21,\n       pt.bg=cols[c(1,1,1,2,2)],bty=\"n\",\n       text.col=\"gray32\",cex=0.8,pt.cex=c(2,1,0.1,1,2))\npar(op)"},{"path":"solutions.html","id":"challenge-4-1","chapter":"15 Solutions to the challenges","heading":"15.4 Challenge 4","text":"Try fit PGLS Pagel correlation structure regressing Shade tolerance seed mass. residuals phylogenetically correlated previous regression wood density?","code":"\n# Fit a PGLS with the gls function\nSm.pgls2 <- gls(Shade ~ Sm, data = seedplantsdata, correlation=pagel.corr)\n# Get the results\nsummary(Sm.pgls2)## Generalized least squares fit by REML\n##   Model: Shade ~ Sm \n##   Data: seedplantsdata \n##        AIC      BIC    logLik\n##   187.6889 195.7183 -89.84447\n## \n## Correlation Structure: corPagel\n##  Formula: ~Code \n##  Parameter estimate(s):\n##   lambda \n## 0.951553 \n## \n## Coefficients:\n##                  Value Std.Error   t-value p-value\n## (Intercept)  2.8204268  1.497276  1.883705  0.0649\n## Sm          -0.0000716  0.000060 -1.193604  0.2378\n## \n##  Correlation: \n##    (Intr)\n## Sm -0.009\n## \n## Standardized residuals:\n##        Min         Q1        Med         Q3        Max \n## -0.6946682 -0.3115198  0.1068607  0.2604470  0.8319385 \n## \n## Residual standard error: 2.620527 \n## Degrees of freedom: 57 total; 55 residual"},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
