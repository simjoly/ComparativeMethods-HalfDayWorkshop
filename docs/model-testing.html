<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Model testing | Half-day Workshop on Phylogenetic Comparative Methods</title>
<meta name="author" content="Simon Joly">
<meta name="description" content="You might be interested in comparing different models, which is a common approach to modelisation in biology. However, there is a slight twist that you need to be aware of with PGLS. The default...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="9 Model testing | Half-day Workshop on Phylogenetic Comparative Methods">
<meta property="og:type" content="book">
<meta property="og:url" content="https://simjoly.github.io/ComparativeMethods-HalfDayWorkshop/model-testing.html">
<meta property="og:description" content="You might be interested in comparing different models, which is a common approach to modelisation in biology. However, there is a slight twist that you need to be aware of with PGLS. The default...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Model testing | Half-day Workshop on Phylogenetic Comparative Methods">
<meta name="twitter:description" content="You might be interested in comparing different models, which is a common approach to modelisation in biology. However, there is a slight twist that you need to be aware of with PGLS. The default...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Half-day Workshop on Phylogenetic Comparative Methods</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="before.html"><span class="header-section-number">2</span> Ahead of the workshop</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">3</span> An introduction to Phylogenetic Comparative Methods</a></li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">4</span> The linear regression model</a></li>
<li><a class="" href="pgls.html"><span class="header-section-number">5</span> Phylogenetic generalized least squares (PGLS)</a></li>
<li><a class="" href="pic.html"><span class="header-section-number">6</span> Phylogenetic Independent Contrasts</a></li>
<li><a class="" href="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html"><span class="header-section-number">7</span> Relaxing the assumption that residuals need to be perfectly phylogenetically correlated</a></li>
<li><a class="" href="phylogenetic-anova.html"><span class="header-section-number">8</span> Phylogenetic ANOVA</a></li>
<li><a class="active" href="model-testing.html"><span class="header-section-number">9</span> Model testing</a></li>
<li><a class="" href="when-should-we-use-comparative-methods.html"><span class="header-section-number">10</span> When should we use comparative methods?</a></li>
<li><a class="" href="a-final-word-the-problem-of-replication.html"><span class="header-section-number">11</span> A final word: the problem of replication</a></li>
<li><a class="" href="BM-model.html"><span class="header-section-number">12</span> The Brownian Motion (BM) model</a></li>
<li><a class="" href="further-readings.html"><span class="header-section-number">13</span> Further readings</a></li>
<li><a class="" href="trees.html"><span class="header-section-number">14</span> Introduction to phylogenies in R</a></li>
<li><a class="" href="solutions.html"><span class="header-section-number">15</span> Solutions to the challenges</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="model-testing" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Model testing<a class="anchor" aria-label="anchor" href="#model-testing"><i class="fas fa-link"></i></a>
</h1>
<p>You might be interested in comparing different models, which is a common approach to modelisation in biology. However, there is a slight twist that you need to be aware of with PGLS.</p>
<p>The default method for model fitting with <code>gls</code> is restricted maximum likelihood estimation (REML), obtained by <code>method="REML"</code>. This is different than standard maximum likelihood estimation (ML), which can be obtained with <code>method="ML"</code>. The difference between these is complex, but suffice to say that they differ in the way the variance parameters are estimated. REML provides less biased parameter estimates and is the preferred method to report the parameter coefficients in a publication. It is also the method of choice if you want to compare models with different correlation (or variance) structures <span class="citation">(<a href="references.html#ref-zuur2009mixed">Zuur et al. 2009</a>)</span>. For example, if you want to test whether a PGLS model with an optimized Pagelâ€™s <span class="math inline">\(\lambda\)</span> fits the data better than a model with no phylogenetic correlation (that is, with Pagel <span class="math inline">\(\lambda=0\)</span>):</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pagel.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">Shade</span> <span class="op">~</span> <span class="va">Wd</span>, data <span class="op">=</span> <span class="va">seedplantsdata</span>, </span>
<span>               correlation<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/corPagel.html">corPagel</a></span><span class="op">(</span><span class="fl">0</span>,phy<span class="op">=</span><span class="va">seedplantstree</span>, </span>
<span>                                    fixed<span class="op">=</span><span class="cn">TRUE</span>, form<span class="op">=</span><span class="op">~</span><span class="va">Code</span><span class="op">)</span>, </span>
<span>               method<span class="op">=</span><span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="va">pagel.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">Shade</span> <span class="op">~</span> <span class="va">Wd</span>, data <span class="op">=</span> <span class="va">seedplantsdata</span>, </span>
<span>                 correlation<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/corPagel.html">corPagel</a></span><span class="op">(</span><span class="fl">0.8</span>,phy<span class="op">=</span><span class="va">seedplantstree</span>, </span>
<span>                                      fixed<span class="op">=</span><span class="cn">FALSE</span>, form<span class="op">=</span><span class="op">~</span><span class="va">Code</span><span class="op">)</span>,</span>
<span>                 method<span class="op">=</span><span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">pagel.0</span>,<span class="va">pagel.fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>##           Model df      AIC     BIC    logLik   Test  L.Ratio p-value
## pagel.0       1  3 180.4720 186.494 -87.23602                        
## pagel.fit     2  4 163.3967 171.426 -77.69833 1 vs 2 19.07537  &lt;.0001</code></pre>
<p>You can use the AIC or BIC to compare the model, or the likelihood ratio test. You can see here that the PGLS model with a fitted Pagel <span class="math inline">\(\lambda\)</span> has a better fit than the one with a <span class="math inline">\(\lambda=0\)</span> (smaller AIC). By the way, this is also a test of whether a PGLS model is better than a standard regression model as a corPagel structure with <span class="math inline">\(\lambda=0\)</span> is a standard model (= no phylogenetic correlation).</p>
<p>Now, if you are interested in testing the fixed parameters in the model, you need to use maximum likelihood fitting <span class="citation">(<a href="references.html#ref-zuur2009mixed">Zuur et al. 2009</a>)</span>. For instance, if you want to use a likelihood ratio test to test the model with wood density as independent variable versus a null model with just the intercept, you can do the following.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">Shade</span> <span class="op">~</span> <span class="va">Wd</span>, data <span class="op">=</span> <span class="va">seedplantsdata</span>,</span>
<span>          correlation<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/corBrownian.html">corBrownian</a></span><span class="op">(</span>phy<span class="op">=</span><span class="va">seedplantstree</span>, form<span class="op">=</span><span class="op">~</span><span class="va">Code</span><span class="op">)</span>, </span>
<span>          method<span class="op">=</span><span class="st">"ML"</span><span class="op">)</span></span>
<span><span class="va">null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">Shade</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">seedplantsdata</span>,</span>
<span>            correlation<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/corBrownian.html">corBrownian</a></span><span class="op">(</span>phy<span class="op">=</span><span class="va">seedplantstree</span>, form<span class="op">=</span><span class="op">~</span><span class="va">Code</span><span class="op">)</span>, </span>
<span>            method<span class="op">=</span><span class="st">"ML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">wd</span>,<span class="va">null</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      Model df      AIC      BIC    logLik   Test  L.Ratio p-value
## wd       1  3 222.0088 228.1380 -108.0044                        
## null     2  2 226.4988 230.5848 -111.2494 1 vs 2 6.489907  0.0108</code></pre>
<p>You can see the model with the wood density variable is better than the model with only the intercept. However, as mentioned above, because the REML fitting provides better parameter estimates, you would have to refit the model using REML to present the results.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wd.final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">Shade</span> <span class="op">~</span> <span class="va">Wd</span>, data <span class="op">=</span> <span class="va">seedplantsdata</span>,</span>
<span>                correlation<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/corBrownian.html">corBrownian</a></span><span class="op">(</span>phy<span class="op">=</span><span class="va">seedplantstree</span>, form<span class="op">=</span><span class="op">~</span><span class="va">Code</span><span class="op">)</span>, </span>
<span>                method<span class="op">=</span><span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">wd.final</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Generalized least squares fit by REML
##   Model: Shade ~ Wd 
##   Data: seedplantsdata 
##        AIC      BIC    logLik
##   214.3762 220.3982 -104.1881
## 
## Correlation Structure: corBrownian
##  Formula: ~Code 
##  Parameter estimate(s):
## numeric(0)
## 
## Coefficients:
##                Value Std.Error   t-value p-value
## (Intercept) 0.911433  4.409058 0.2067184  0.8370
## Wd          4.361028  1.693349 2.5753865  0.0127
## 
##  Correlation: 
##    (Intr)
## Wd -0.166
## 
## Standardized residuals:
##         Min          Q1         Med          Q3         Max 
## -0.26890642 -0.16431866 -0.02645422  0.09638984  0.34953444 
## 
## Residual standard error: 7.455109 
## Degrees of freedom: 57 total; 55 residual</code></pre>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="phylogenetic-anova.html"><span class="header-section-number">8</span> Phylogenetic ANOVA</a></div>
<div class="next"><a href="when-should-we-use-comparative-methods.html"><span class="header-section-number">10</span> When should we use comparative methods?</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#model-testing"><span class="header-section-number">9</span> Model testing</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Half-day Workshop on Phylogenetic Comparative Methods</strong>" was written by Simon Joly. It was last built on 2024-11-09.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
