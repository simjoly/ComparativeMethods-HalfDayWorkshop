<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Importing and plotting trees | Half-day Workshop on Phylogenetic Comparative Methods</title>
  <meta name="description" content="This is a book that contains information on a half-day introductoray workshop on Phylogenetic Comparative Methods" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Importing and plotting trees | Half-day Workshop on Phylogenetic Comparative Methods" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a book that contains information on a half-day introductoray workshop on Phylogenetic Comparative Methods" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Importing and plotting trees | Half-day Workshop on Phylogenetic Comparative Methods" />
  
  <meta name="twitter:description" content="This is a book that contains information on a half-day introductoray workshop on Phylogenetic Comparative Methods" />
  

<meta name="author" content="Simon Joly" />


<meta name="date" content="2023-02-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="trees.html"/>
<link rel="next" href="handling-multiple-trees.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PCM workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#useful-resources"><i class="fa fa-check"></i><b>1.1</b> Useful resources</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#source"><i class="fa fa-check"></i><b>1.2</b> Source</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i><b>1.3</b> Disclaimer</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="before.html"><a href="before.html"><i class="fa fa-check"></i><b>2</b> Ahead of the workshop</a>
<ul>
<li class="chapter" data-level="2.1" data-path="before.html"><a href="before.html#install-r-and-the-required-packages"><i class="fa fa-check"></i><b>2.1</b> Install R and the required packages</a></li>
<li class="chapter" data-level="2.2" data-path="before.html"><a href="before.html#download"><i class="fa fa-check"></i><b>2.2</b> Downloading the data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>3</b> An introduction to Phylogenetic Comparative Methods</a></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> The linear regression model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="linear-regression.html"><a href="linear-regression.html#theory"><i class="fa fa-check"></i><b>4.1</b> Theory</a></li>
<li class="chapter" data-level="4.2" data-path="linear-regression.html"><a href="linear-regression.html#practice"><i class="fa fa-check"></i><b>4.2</b> Practice</a></li>
<li class="chapter" data-level="4.3" data-path="linear-regression.html"><a href="linear-regression.html#challenge-1"><i class="fa fa-check"></i><b>4.3</b> Challenge 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pgls.html"><a href="pgls.html"><i class="fa fa-check"></i><b>5</b> Phylogenetic generalized least squares (PGLS)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="pgls.html"><a href="pgls.html#theory-1"><i class="fa fa-check"></i><b>5.1</b> Theory</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="pgls.html"><a href="pgls.html#phylogenetic-correlation-structure"><i class="fa fa-check"></i><b>5.1.1</b> Phylogenetic correlation structure</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="pgls.html"><a href="pgls.html#challenge-2"><i class="fa fa-check"></i><b>5.2</b> Challenge 2</a></li>
<li class="chapter" data-level="5.3" data-path="pgls.html"><a href="pgls.html#practicals"><i class="fa fa-check"></i><b>5.3</b> Practicals</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="pgls.html"><a href="pgls.html#other-correlation-structures"><i class="fa fa-check"></i><b>5.3.1</b> Other correlation structures</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="pgls.html"><a href="pgls.html#challenge-3"><i class="fa fa-check"></i><b>5.4</b> Challenge 3</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pic.html"><a href="pic.html"><i class="fa fa-check"></i><b>6</b> Phylogenetic Independent Contrasts</a></li>
<li class="chapter" data-level="7" data-path="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html"><a href="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html"><i class="fa fa-check"></i><b>7</b> Relaxing the assumption that residuals need to be perfectly phylogenetically correlated</a>
<ul>
<li class="chapter" data-level="7.1" data-path="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html"><a href="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html#theory-pagels-correlation-structure"><i class="fa fa-check"></i><b>7.1</b> Theory: Pagel’s correlation structure</a></li>
<li class="chapter" data-level="7.2" data-path="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html"><a href="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html#practicals-1"><i class="fa fa-check"></i><b>7.2</b> Practicals</a></li>
<li class="chapter" data-level="7.3" data-path="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html"><a href="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html#challenge-4"><i class="fa fa-check"></i><b>7.3</b> Challenge 4</a></li>
<li class="chapter" data-level="7.4" data-path="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html"><a href="relaxing-the-assumption-that-residuals-need-to-be-perfectly-phylogenetically-correlated.html#other-correlation-structures-or-evolutionary-models"><i class="fa fa-check"></i><b>7.4</b> Other correlation structures (or evolutionary models)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="phylogenetic-anova.html"><a href="phylogenetic-anova.html"><i class="fa fa-check"></i><b>8</b> Phylogenetic ANOVA</a></li>
<li class="chapter" data-level="9" data-path="model-testing.html"><a href="model-testing.html"><i class="fa fa-check"></i><b>9</b> Model testing</a></li>
<li class="chapter" data-level="10" data-path="when-should-we-use-comparative-methods.html"><a href="when-should-we-use-comparative-methods.html"><i class="fa fa-check"></i><b>10</b> When should we use comparative methods?</a></li>
<li class="chapter" data-level="11" data-path="a-final-word-the-problem-of-replication.html"><a href="a-final-word-the-problem-of-replication.html"><i class="fa fa-check"></i><b>11</b> A final word: the problem of replication</a></li>
<li class="chapter" data-level="12" data-path="BM-model.html"><a href="BM-model.html"><i class="fa fa-check"></i><b>12</b> The Brownian Motion (BM) model</a></li>
<li class="chapter" data-level="13" data-path="further-readings.html"><a href="further-readings.html"><i class="fa fa-check"></i><b>13</b> Further readings</a></li>
<li class="chapter" data-level="14" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>14</b> Solutions to the challenges</a>
<ul>
<li class="chapter" data-level="14.1" data-path="solutions.html"><a href="solutions.html#challenge-1-1"><i class="fa fa-check"></i><b>14.1</b> Challenge 1</a></li>
<li class="chapter" data-level="14.2" data-path="solutions.html"><a href="solutions.html#challenge-2-1"><i class="fa fa-check"></i><b>14.2</b> Challenge 2</a></li>
<li class="chapter" data-level="14.3" data-path="solutions.html"><a href="solutions.html#challenge-3-1"><i class="fa fa-check"></i><b>14.3</b> Challenge 3</a></li>
<li class="chapter" data-level="14.4" data-path="solutions.html"><a href="solutions.html#challenge-4-1"><i class="fa fa-check"></i><b>14.4</b> Challenge 4</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="trees.html"><a href="trees.html"><i class="fa fa-check"></i><b>15</b> Introduction to phylogenies in R</a></li>
<li class="chapter" data-level="16" data-path="importing-and-plotting-trees.html"><a href="importing-and-plotting-trees.html"><i class="fa fa-check"></i><b>16</b> Importing and plotting trees</a>
<ul>
<li class="chapter" data-level="16.1" data-path="importing-and-plotting-trees.html"><a href="importing-and-plotting-trees.html#simulate-a-tree"><i class="fa fa-check"></i><b>16.1</b> Simulate a tree</a></li>
<li class="chapter" data-level="16.2" data-path="importing-and-plotting-trees.html"><a href="importing-and-plotting-trees.html#simulating-characters"><i class="fa fa-check"></i><b>16.2</b> Simulating characters</a></li>
<li class="chapter" data-level="16.3" data-path="importing-and-plotting-trees.html"><a href="importing-and-plotting-trees.html#import-data-into-r"><i class="fa fa-check"></i><b>16.3</b> Import data into R</a></li>
<li class="chapter" data-level="16.4" data-path="importing-and-plotting-trees.html"><a href="importing-and-plotting-trees.html#plot-trees"><i class="fa fa-check"></i><b>16.4</b> Plot trees</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="handling-multiple-trees.html"><a href="handling-multiple-trees.html"><i class="fa fa-check"></i><b>17</b> Handling multiple trees</a></li>
<li class="chapter" data-level="18" data-path="manipulating-trees.html"><a href="manipulating-trees.html"><i class="fa fa-check"></i><b>18</b> Manipulating trees</a>
<ul>
<li class="chapter" data-level="18.1" data-path="manipulating-trees.html"><a href="manipulating-trees.html#drop-tips"><i class="fa fa-check"></i><b>18.1</b> Drop tips</a></li>
<li class="chapter" data-level="18.2" data-path="manipulating-trees.html"><a href="manipulating-trees.html#reroot-trees"><i class="fa fa-check"></i><b>18.2</b> Reroot trees</a></li>
<li class="chapter" data-level="18.3" data-path="manipulating-trees.html"><a href="manipulating-trees.html#get-cophenetic-distances"><i class="fa fa-check"></i><b>18.3</b> Get cophenetic distances</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Half-day Workshop on Phylogenetic Comparative Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="importing-and-plotting-trees" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">16</span> Importing and plotting trees<a href="importing-and-plotting-trees.html#importing-and-plotting-trees" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="simulate-a-tree" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Simulate a tree<a href="importing-and-plotting-trees.html#simulate-a-tree" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Throughout these exercises, we will often use simulated trees, which are very useful for pedagogical purposes. Trees can be simulated using several functions, but here is an example to simulate one tree with 15 species.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="importing-and-plotting-trees.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(phytools)</span>
<span id="cb61-2"><a href="importing-and-plotting-trees.html#cb61-2" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">pbtree</span>(<span class="at">n=</span><span class="dv">15</span>,<span class="at">nsim=</span><span class="dv">1</span>)</span>
<span id="cb61-3"><a href="importing-and-plotting-trees.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree)</span></code></pre></div>
<p><img src="pcm-workshop_files/figure-html/Simulate%20Pure-Birth%20Tree-1.png" width="672" /></p>
<p>You save the tree in nexus format to a file. But before you do so, it is a good idea to set the working directory to the same folder where your script is saved. You can do that in RStudio in the menu Session&gt;Set Working Directory&gt;To Source File Location.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="importing-and-plotting-trees.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ape)</span>
<span id="cb62-2"><a href="importing-and-plotting-trees.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.nexus</span>(tree, <span class="at">file=</span><span class="st">&quot;My_first_tree.tre&quot;</span>)</span></code></pre></div>
</div>
<div id="simulating-characters" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Simulating characters<a href="importing-and-plotting-trees.html#simulating-characters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Characters can also be easily simulated in R. For instance, you could simulate a character using a Brownian Motion (BM) model using the following code.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="importing-and-plotting-trees.html#cb63-1" aria-hidden="true" tabindex="-1"></a>trait1 <span class="ot">&lt;-</span> <span class="fu">fastBM</span>(tree, <span class="at">sig2=</span><span class="fl">0.01</span>, <span class="at">nsim=</span><span class="dv">1</span>, <span class="at">internal=</span><span class="cn">FALSE</span>)</span>
<span id="cb63-2"><a href="importing-and-plotting-trees.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To get trait values for tree tips:</span></span>
<span id="cb63-3"><a href="importing-and-plotting-trees.html#cb63-3" aria-hidden="true" tabindex="-1"></a>trait1</span></code></pre></div>
<pre><code>##           t3           t4           t7           t8           t2          t14 
## -0.007306853  0.043251831  0.004858391 -0.114795593 -0.043737891  0.113964926 
##          t15           t9          t12          t13           t5           t6 
##  0.097243984  0.096978766  0.063069656  0.053040643  0.072476832  0.034675083 
##           t1          t10          t11 
## -0.084659118  0.118596501  0.059071786</code></pre>
<p>Now, let’s save this trait to a file to pretend it is our original data.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="importing-and-plotting-trees.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">matrix</span>(trait1,<span class="at">ncol=</span><span class="dv">1</span>,<span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">names</span>(trait1),<span class="st">&quot;trait1&quot;</span>)), <span class="at">file=</span><span class="st">&quot;mytrait.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span></code></pre></div>
<p>Now that we have simulated a tree and a character, let’s erase what we have done so far from the R environment and pretend these are our data for the next sections.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="importing-and-plotting-trees.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="import-data-into-r" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Import data into R<a href="importing-and-plotting-trees.html#import-data-into-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here is how you should import your data into R.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="importing-and-plotting-trees.html#cb67-1" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">read.nexus</span>(<span class="at">file=</span><span class="st">&quot;My_first_tree.tre&quot;</span>)</span>
<span id="cb67-2"><a href="importing-and-plotting-trees.html#cb67-2" aria-hidden="true" tabindex="-1"></a>trait1 <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="at">file=</span><span class="st">&quot;mytrait.csv&quot;</span>,<span class="at">dec=</span><span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<p>The tree format in ape contains several information and it is useful to know how to access them. For instance, the tip labels can be accessed using <code>tree$tip.label</code> and the branch lengths using <code>tree$edge.length</code>. Will will see more options in other exercises, but if you want more detailed information on how the objects “phylo” are organized, you can have a look the help file <code>?read.tree</code> or at this <a href="http://ape-package.ird.fr/misc/FormatTreeR_24Oct2012.pdf">document</a> prepared by Emmanuel Paradis, the author of <code>ape</code>.</p>
</div>
<div id="plot-trees" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Plot trees<a href="importing-and-plotting-trees.html#plot-trees" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Plotting trees is one of the very interesting aspects of using R. Options are numerous and possibilities large. The most common function is <code>plot.phylo</code> from the ape package that has a lot of different options. I strongly suggest that you take a close look at the different options of the function <code>?plot.phylo</code>. Here is a basic example.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="importing-and-plotting-trees.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree, <span class="at">type=</span><span class="st">&quot;c&quot;</span>)</span>
<span id="cb68-2"><a href="importing-and-plotting-trees.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add.scale.bar</span>()</span></code></pre></div>
<p><img src="pcm-workshop_files/figure-html/Basic%20tree%20plotting-1.png" width="672" /></p>
<p>But R is also interesting to plot characters alongside trees. If you have a categorical character, you could use it to color the tips of the phylogeny.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="importing-and-plotting-trees.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a random categorical character</span></span>
<span id="cb69-2"><a href="importing-and-plotting-trees.html#cb69-2" aria-hidden="true" tabindex="-1"></a>trait2 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">size=</span><span class="fu">length</span>(tree<span class="sc">$</span>tip.label),<span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb69-3"><a href="importing-and-plotting-trees.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create color palette</span></span>
<span id="cb69-4"><a href="importing-and-plotting-trees.html#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb69-5"><a href="importing-and-plotting-trees.html#cb69-5" aria-hidden="true" tabindex="-1"></a>ColorPalette1 <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="fu">length</span>(<span class="fu">levels</span>(trait2)), <span class="at">name =</span> <span class="st">&quot;Dark2&quot;</span>)</span>
<span id="cb69-6"><a href="importing-and-plotting-trees.html#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree, <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">use.edge.length =</span> <span class="cn">TRUE</span>, <span class="at">label.offset=</span><span class="fl">0.2</span>,<span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb69-7"><a href="importing-and-plotting-trees.html#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch=</span><span class="dv">21</span>,<span class="at">bg=</span>ColorPalette1[trait2],<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">cex=</span><span class="dv">1</span>,<span class="at">adj=</span><span class="fl">0.6</span>)</span>
<span id="cb69-8"><a href="importing-and-plotting-trees.html#cb69-8" aria-hidden="true" tabindex="-1"></a>op<span class="ot">&lt;-</span><span class="fu">par</span>(<span class="at">xpd=</span><span class="cn">TRUE</span>)</span>
<span id="cb69-9"><a href="importing-and-plotting-trees.html#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">legend=</span><span class="fu">levels</span>(trait2),<span class="at">col=</span>ColorPalette1,</span>
<span id="cb69-10"><a href="importing-and-plotting-trees.html#cb69-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">20</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>,<span class="at">cex=</span><span class="dv">1</span>,<span class="at">pt.cex=</span><span class="fl">1.5</span>,<span class="at">ncol=</span><span class="fu">length</span>(<span class="fu">levels</span>(trait2)))</span></code></pre></div>
<p><img src="pcm-workshop_files/figure-html/Plot%20categorical%20parameter-1.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="importing-and-plotting-trees.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op) <span class="co">#reset graphical parameters to defaults</span></span></code></pre></div>
<p>A similar result could be obtained with a continuous variable. Here, we will use the Brownian Motion model, which we will study in a further class, to simulate the continuous character.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="importing-and-plotting-trees.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Breakdown continuous trait in categories</span></span>
<span id="cb71-2"><a href="importing-and-plotting-trees.html#cb71-2" aria-hidden="true" tabindex="-1"></a>trait1.cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(trait1[,<span class="dv">1</span>],<span class="at">breaks=</span><span class="dv">8</span>,<span class="at">labels=</span><span class="cn">FALSE</span>)</span>
<span id="cb71-3"><a href="importing-and-plotting-trees.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create color palette</span></span>
<span id="cb71-4"><a href="importing-and-plotting-trees.html#cb71-4" aria-hidden="true" tabindex="-1"></a>ColorPalette2 <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">name =</span> <span class="st">&quot;Blues&quot;</span>)</span>
<span id="cb71-5"><a href="importing-and-plotting-trees.html#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the tree</span></span>
<span id="cb71-6"><a href="importing-and-plotting-trees.html#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree, <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">use.edge.length =</span> <span class="cn">TRUE</span>, <span class="at">label.offset=</span><span class="fl">0.2</span>,<span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb71-7"><a href="importing-and-plotting-trees.html#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch=</span><span class="dv">21</span>,<span class="at">bg=</span>ColorPalette2[trait1.cat],<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">cex=</span><span class="dv">1</span>,<span class="at">adj=</span><span class="fl">0.6</span>)</span>
<span id="cb71-8"><a href="importing-and-plotting-trees.html#cb71-8" aria-hidden="true" tabindex="-1"></a>op<span class="ot">&lt;-</span><span class="fu">par</span>(<span class="at">xpd=</span><span class="cn">TRUE</span>)</span>
<span id="cb71-9"><a href="importing-and-plotting-trees.html#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">legend=</span><span class="fu">levels</span>(<span class="fu">cut</span>(trait1[,<span class="dv">1</span>],<span class="at">breaks=</span><span class="dv">8</span>)),</span>
<span id="cb71-10"><a href="importing-and-plotting-trees.html#cb71-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span>ColorPalette2,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>,<span class="at">cex=</span><span class="fl">0.7</span>,<span class="at">pt.cex=</span><span class="fl">1.5</span>,<span class="at">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="pcm-workshop_files/figure-html/Plot%20continuous%20parameter-1.png" width="672" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="importing-and-plotting-trees.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op) <span class="co">#reset graphical parameters to defaults</span></span></code></pre></div>
<p>As expected from a character simlated with Brownian motion, you can see that closely related species tend to have more similar character values.</p>
<p>Another option to represent a continuous parameter is to use the function <code>table.phylo4d</code> from the <code>adephylo</code> package to represent the trait where its values are represented by sizes of different sizes and colors. It is also possible to plot multiple characters at the same time.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="importing-and-plotting-trees.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phylobase)</span>
<span id="cb73-2"><a href="importing-and-plotting-trees.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adephylo)</span>
<span id="cb73-3"><a href="importing-and-plotting-trees.html#cb73-3" aria-hidden="true" tabindex="-1"></a>trait3 <span class="ot">&lt;-</span> <span class="fu">fastBM</span>(tree, <span class="at">sig2=</span><span class="fl">0.1</span>, <span class="at">nsim=</span><span class="dv">1</span>, <span class="at">internal=</span><span class="cn">FALSE</span>) <span class="co">#simulate a faster evolving trait</span></span>
<span id="cb73-4"><a href="importing-and-plotting-trees.html#cb73-4" aria-hidden="true" tabindex="-1"></a>trait.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">trait1=</span>trait1[,<span class="dv">1</span>], trait3)</span>
<span id="cb73-5"><a href="importing-and-plotting-trees.html#cb73-5" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">phylo4d</span>(tree, trait.table) <span class="co"># build a phylo4d object</span></span>
<span id="cb73-6"><a href="importing-and-plotting-trees.html#cb73-6" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb73-7"><a href="importing-and-plotting-trees.html#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table.phylo4d</span>(obj,<span class="at">cex.label=</span><span class="dv">1</span>,<span class="at">cex.symbol=</span><span class="dv">1</span>,<span class="at">ratio.tree=</span><span class="fl">0.8</span>,<span class="at">grid=</span><span class="cn">FALSE</span>,<span class="at">box=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="pcm-workshop_files/figure-html/Plot%20continuous%20parameter%20-%20table.phylo4d-1.png" width="672" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="importing-and-plotting-trees.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op) <span class="co">#reset graphical parameters to defaults</span></span></code></pre></div>
<p>You can also represent a traitgram:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="importing-and-plotting-trees.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(phytools)</span>
<span id="cb75-2"><a href="importing-and-plotting-trees.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">phenogram</span>(tree,trait3,<span class="at">spread.labels=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="pcm-workshop_files/figure-html/traitgram-1.png" width="672" /></p>
<p>Finally, it is also possible to represent a tree on a 2-dimensional plot, coloring points with the categorical variable.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="importing-and-plotting-trees.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">phylomorphospace</span>(tree,trait.table)</span>
<span id="cb76-2"><a href="importing-and-plotting-trees.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(trait.table,<span class="at">pch=</span><span class="dv">21</span>,<span class="at">bg=</span>ColorPalette1[trait2],<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">cex=</span><span class="fl">1.2</span>,<span class="at">adj=</span><span class="dv">1</span>)</span>
<span id="cb76-3"><a href="importing-and-plotting-trees.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">legend=</span><span class="fu">levels</span>(trait2),</span>
<span id="cb76-4"><a href="importing-and-plotting-trees.html#cb76-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span>ColorPalette1,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>,<span class="at">cex=</span><span class="dv">1</span>,<span class="at">pt.cex=</span><span class="fl">1.5</span>,<span class="at">ncol=</span><span class="fu">length</span>(<span class="fu">levels</span>(trait2)))</span></code></pre></div>
<p><img src="pcm-workshop_files/figure-html/Phylomorphospace-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="trees.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="handling-multiple-trees.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/10-trees.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["pcm-workshop.pdf", "pcm-workshop.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
